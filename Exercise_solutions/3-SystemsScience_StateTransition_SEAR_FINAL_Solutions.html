<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Roch Nianogo &amp; Ashley Buchanan">
<meta name="dcterms.date" content="2025-07-07">

<title>Systems Science Modeling and Simulation Methods for Epidemiologic Research: A Tutorial</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="SystemsScience_StateTransition_SEAR_FINAL_Solutions_files/libs/clipboard/clipboard.min.js"></script>
<script src="SystemsScience_StateTransition_SEAR_FINAL_Solutions_files/libs/quarto-html/quarto.js"></script>
<script src="SystemsScience_StateTransition_SEAR_FINAL_Solutions_files/libs/quarto-html/popper.min.js"></script>
<script src="SystemsScience_StateTransition_SEAR_FINAL_Solutions_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="SystemsScience_StateTransition_SEAR_FINAL_Solutions_files/libs/quarto-html/anchor.min.js"></script>
<link href="SystemsScience_StateTransition_SEAR_FINAL_Solutions_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="SystemsScience_StateTransition_SEAR_FINAL_Solutions_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="SystemsScience_StateTransition_SEAR_FINAL_Solutions_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="SystemsScience_StateTransition_SEAR_FINAL_Solutions_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="SystemsScience_StateTransition_SEAR_FINAL_Solutions_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">


</head>

<body>

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#state-transition-model-stm" id="toc-state-transition-model-stm" class="nav-link active" data-scroll-target="#state-transition-model-stm">2) State Transition Model (STM)</a></li>
  </ul>
<div class="quarto-alternate-formats"><h2>Other Formats</h2><ul><li><a href="SystemsScience_StateTransition_SEAR_FINAL_Solutions.pdf"><i class="bi bi-file-pdf"></i>PDF</a></li></ul></div></nav>
</div>
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Systems Science Modeling and Simulation Methods for Epidemiologic Research: A Tutorial</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Roch Nianogo &amp; Ashley Buchanan </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">July 7, 2025</p>
    </div>
  </div>
  
    
  </div>
  


</header>


<section id="state-transition-model-stm" class="level1">
<h1>2) State Transition Model (STM)</h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">require</span>(<span class="st">"pacman"</span>)){</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">install.packages</span>(<span class="st">"pacman"</span>, <span class="at">repos =</span> <span class="st">'http://cran.us.r-project.org'</span>)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: pacman</code></pre>
</div>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(<span class="st">"tidyverse"</span>,</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>               <span class="st">"broom"</span>,</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>               <span class="st">"here"</span>,</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>               <span class="st">"ggdag"</span>,</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>               <span class="st">"glue"</span>,</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>               <span class="st">"diagram"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<table class="caption-top table">
<thead>
<tr class="header">
<th></th>
<th>Susceptible (S)</th>
<th>Exposed (E)</th>
<th>Adopted (A)</th>
<th>Reduced weight (R)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Susceptible (S)</td>
<td>p_SS</td>
<td>p_SE</td>
<td>p_SA</td>
<td>p_SR</td>
</tr>
<tr class="even">
<td>Exposed (E)</td>
<td>0</td>
<td>p_EE</td>
<td>p_EA</td>
<td>p_ER</td>
</tr>
<tr class="odd">
<td>Adopted (A)</td>
<td>0</td>
<td>0</td>
<td>p_AA</td>
<td>p_AR</td>
</tr>
<tr class="even">
<td>Reduced weight (R)</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>p_RR</td>
</tr>
</tbody>
</table>
<ul>
<li><p><code>p_SS</code>: Probability of remaining susceptible.</p></li>
<li><p><code>p_SE</code>: Probability of moving from susceptible to exposed.</p></li>
<li><p><code>p_SA</code>: Probability of moving from susceptible to adopting a behavior.</p></li>
<li><p><code>p_SR</code>: Probability of moving from susceptible to reduced weight.</p></li>
<li><p><code>p_EE</code>: Probability of remaining in an exposed state.</p></li>
<li><p><code>p_EA</code>: Probability of moving from exposed to adopting a behavior.</p></li>
<li><p><code>p_ER</code>: Probability of moving from exposed to reduced weight.</p></li>
<li><p><code>p_AA</code>: Probability of remaining in an adopted behavior state.</p></li>
<li><p><code>p_AR</code>: Probability of moving from behavior adopted to reduced weight.</p></li>
<li><p><code>p_RR</code>: Probability of remaining in a reduced weight state.</p></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>p_se <span class="ot">=</span> <span class="fl">0.012</span>  <span class="co"># Probability of moving from S to E (probability of being exposed to an intervention)</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="co">#Probability of moving from susceptible to exposed.</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>p_sa <span class="ot">=</span> <span class="fl">0.003</span>  <span class="co"># Probability of moving from S to A (probability of adopting a behavior)</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a><span class="co">#Probability of moving from susceptible to adopting a behavior.</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>p_sr <span class="ot">=</span> <span class="fl">0.001</span>  <span class="co"># Probability of moving from S to R (probability of being in reduced weight state)</span></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a><span class="co">#Probability of moving from susceptible to reduced weight.</span></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>p_ea <span class="ot">=</span> <span class="fl">0.008</span>  <span class="co"># Probability of moving from E to A (probability of adopting a behavior)</span></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a><span class="co">#Probability of mving from exposed to adopted behavior</span></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>p_er <span class="ot">=</span> <span class="fl">0.0005</span> <span class="co"># Probability of moving from E to R (probability of having a reduced weight)</span></span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a><span class="co">#Probability of moving from exposed  to reduced weight</span></span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>p_ar <span class="ot">=</span> <span class="fl">0.003</span>  <span class="co"># Probability of moving from A to R (probability of having a reduced weight)</span></span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a><span class="co">#Probability of moving from behavior adopted to reduced weight</span></span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a>p_rr <span class="ot">=</span> <span class="dv">1</span>      <span class="co"># Probability of staying in the reduced weight state (must be one, absorbing state)</span></span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate complementary probabilities</span></span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a>p_ss <span class="ot">=</span> <span class="dv">1</span> <span class="sc">-</span> p_se <span class="sc">-</span> p_sa <span class="sc">-</span> p_sr  <span class="co"># Probability of staying in S</span></span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a>p_ee <span class="ot">=</span> <span class="dv">1</span> <span class="sc">-</span> p_ea <span class="sc">-</span> p_er         <span class="co"># Probability of staying in E</span></span>
<span id="cb4-18"><a href="#cb4-18" aria-hidden="true" tabindex="-1"></a>p_aa <span class="ot">=</span> <span class="dv">1</span> <span class="sc">-</span> p_ar                <span class="co"># Probability of staying in A</span></span>
<span id="cb4-19"><a href="#cb4-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-20"><a href="#cb4-20" aria-hidden="true" tabindex="-1"></a>transition_mat<span class="ot">=</span><span class="fu">matrix</span>(<span class="fu">c</span>(p_ss, p_se, p_sa, p_sr,</span>
<span id="cb4-21"><a href="#cb4-21" aria-hidden="true" tabindex="-1"></a>                        <span class="dv">0</span>,    p_ee, p_ea, p_er,  <span class="co"># Transitions from state S</span></span>
<span id="cb4-22"><a href="#cb4-22" aria-hidden="true" tabindex="-1"></a>                        <span class="dv">0</span>,    <span class="dv">0</span>,    p_aa, p_ar,  <span class="co"># Transitions from state A</span></span>
<span id="cb4-23"><a href="#cb4-23" aria-hidden="true" tabindex="-1"></a>                        <span class="dv">0</span>,    <span class="dv">0</span>,       <span class="dv">0</span>, p_rr), <span class="co"># Transitions from state R</span></span>
<span id="cb4-24"><a href="#cb4-24" aria-hidden="true" tabindex="-1"></a>                <span class="at">byrow =</span> <span class="cn">TRUE</span>,</span>
<span id="cb4-25"><a href="#cb4-25" aria-hidden="true" tabindex="-1"></a>                <span class="at">nrow =</span> <span class="dv">4</span>)</span>
<span id="cb4-26"><a href="#cb4-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-27"><a href="#cb4-27" aria-hidden="true" tabindex="-1"></a><span class="co">#transition matrix does not depend on time (does not depend on time)</span></span>
<span id="cb4-28"><a href="#cb4-28" aria-hidden="true" tabindex="-1"></a>transition_mat</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      [,1]   [,2]  [,3]  [,4]
[1,] 0.984 0.0120 0.003 1e-03
[2,] 0.000 0.9915 0.008 5e-04
[3,] 0.000 0.0000 0.997 3e-03
[4,] 0.000 0.0000 0.000 1e+00</code></pre>
</div>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co">#check that rows sum to 1</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="fu">rowSums</span>(transition_mat)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1 1 1 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(transition_mat) <span class="ot">&lt;-</span> <span class="fu">rownames</span>(transition_mat) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"S"</span>, <span class="st">"E"</span>, <span class="st">"A"</span>, <span class="st">"R"</span>)</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a><span class="do">##### Plot transition matrix</span></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a><span class="fu">plotmat</span>(<span class="at">A =</span> <span class="fu">t</span>(transition_mat), <span class="at">pos =</span> <span class="dv">4</span>, <span class="at">curve =</span> <span class="fl">0.4</span>, <span class="at">name =</span> <span class="fu">rownames</span>(transition_mat),</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>        <span class="at">lwd =</span> <span class="dv">2</span>, <span class="at">arr.len =</span> <span class="fl">0.3</span>, <span class="at">arr.width =</span> <span class="fl">0.1</span>, <span class="at">my =</span> <span class="fl">0.1</span>, <span class="at">shadow.size =</span> <span class="dv">0</span>,</span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>        <span class="at">box.size =</span> <span class="fl">0.05</span>, <span class="at">arr.type =</span> <span class="st">"triangle"</span>, <span class="at">dtext =</span> <span class="sc">-</span><span class="fl">0.8</span>,</span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>        <span class="at">main =</span> <span class="st">"Transition Matrix"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="SystemsScience_StateTransition_SEAR_FINAL_Solutions_files/figure-html/unnamed-chunk-1-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co">#to compute the probabilities for each time</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>stm_simulation <span class="ot">&lt;-</span> <span class="cf">function</span>(initial_state_vec, </span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>                           transition_prob_mat, </span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>                           n_cycles){</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, </span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>              <span class="at">ncol =</span> <span class="fu">length</span>(initial_state_vec), </span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>              <span class="at">nrow =</span> n_cycles) <span class="co"># Initialize Markov trace</span></span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">rbind</span>(initial_state_vec, x) <span class="co"># Markov trace at cycle 0 is initial state vector</span></span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">colnames</span>(x) <span class="ot">&lt;-</span> <span class="fu">colnames</span>(transition_prob_mat) <span class="co"># Columns are the states</span></span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rownames</span>(x) <span class="ot">&lt;-</span> <span class="dv">0</span><span class="sc">:</span>n_cycles <span class="co"># Rows are the model cycles</span></span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (t <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n_cycles){ <span class="co"># Simulating state vectors at each cycle with for loop</span></span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb9-17"><a href="#cb9-17" aria-hidden="true" tabindex="-1"></a>    x[t <span class="sc">+</span> <span class="dv">1</span>, ] <span class="ot">&lt;-</span> x[t, ] <span class="sc">%*%</span> transition_prob_mat</span>
<span id="cb9-18"><a href="#cb9-18" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb9-19"><a href="#cb9-19" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb9-20"><a href="#cb9-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(x)</span>
<span id="cb9-21"><a href="#cb9-21" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb9-22"><a href="#cb9-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-23"><a href="#cb9-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-24"><a href="#cb9-24" aria-hidden="true" tabindex="-1"></a><span class="do">##  simulate markov-chain</span></span>
<span id="cb9-25"><a href="#cb9-25" aria-hidden="true" tabindex="-1"></a>time <span class="ot">=</span> <span class="dv">365</span>     <span class="co">#day intervals</span></span>
<span id="cb9-26"><a href="#cb9-26" aria-hidden="true" tabindex="-1"></a>transition_mat <span class="co">#time invariant</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      S      E     A     R
S 0.984 0.0120 0.003 1e-03
E 0.000 0.9915 0.008 5e-04
A 0.000 0.0000 0.997 3e-03
R 0.000 0.0000 0.000 1e+00</code></pre>
</div>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co">#P(E)=0.05 initially exposed and P(A)=0.02 initially adopted</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="co">#Ensure the probabilities sum to 1</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>initial_states <span class="ot">=</span> <span class="fu">c</span>(<span class="at">S=</span><span class="fl">0.93</span>,<span class="at">E=</span><span class="fl">0.05</span>,<span class="at">A=</span><span class="fl">0.02</span>, <span class="at">R=</span><span class="dv">0</span>)</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>stm <span class="ot">&lt;-</span> <span class="fu">stm_simulation</span>(<span class="at">initial_state_vec=</span>initial_states, </span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>                      <span class="at">transition_prob_mat=</span>transition_mat, </span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>                      <span class="at">n_cycles =</span> time)</span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>stm1 <span class="ot">&lt;-</span> stm <span class="sc">%&gt;%</span> </span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rowid_to_column</span>(<span class="st">"time_steps"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">time_steps=</span>time_steps<span class="dv">-1</span>)</span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a>stm1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    time_steps           S          E          A           R
1            0 0.930000000 0.05000000 0.02000000 0.000000000
2            1 0.915120000 0.06073500 0.02313000 0.001015000
3            2 0.900478080 0.07120019 0.02629185 0.002029877
4            3 0.886070431 0.08140073 0.02948401 0.003044831
5            4 0.871893304 0.09134167 0.03270498 0.004060054
6            5 0.857943011 0.10102798 0.03595327 0.005075733
7            6 0.844215923 0.11046456 0.03922747 0.006092050
8            7 0.830708468 0.11965620 0.04252615 0.007109181
9            8 0.817417133 0.12860763 0.04584795 0.008127296
10           9 0.804338458 0.13732347 0.04919151 0.009146560
11          10 0.791469043 0.14580828 0.05255554 0.010167135
12          11 0.778805538 0.15406654 0.05593875 0.011189175
13          12 0.766344650 0.16210264 0.05933988 0.012212830
14          13 0.754083135 0.16992090 0.06275772 0.013238246
15          14 0.742017805 0.17752557 0.06619106 0.014265562
16          15 0.730145520 0.18492082 0.06963875 0.015294916
17          16 0.718463192 0.19211074 0.07309963 0.016326438
18          17 0.706967781 0.19909935 0.07657261 0.017360256
19          18 0.695656296 0.20589062 0.08005659 0.018396491
20          19 0.684525796 0.21248843 0.08355051 0.019435262
21          20 0.673573383 0.21889659 0.08705335 0.020476684
22          21 0.662796209 0.22511885 0.09056408 0.021520866
23          22 0.652191469 0.23115889 0.09408173 0.022567913
24          23 0.641756406 0.23702034 0.09760533 0.023617930
25          24 0.631488303 0.24270674 0.10113394 0.024671012
26          25 0.621384491 0.24822159 0.10466666 0.025727256
27          26 0.611442339 0.25356832 0.10820259 0.026786751
28          27 0.601659261 0.25875030 0.11174085 0.027849585
29          28 0.592032713 0.26377084 0.11528061 0.028915842
30          29 0.582560190 0.26863318 0.11882103 0.029985602
31          30 0.573239227 0.27334052 0.12236132 0.031058942
32          31 0.564067399 0.27789599 0.12590067 0.032135935
33          32 0.555042321 0.28230269 0.12943834 0.033216653
34          33 0.546161644 0.28656362 0.13297357 0.034301161
35          34 0.537423057 0.29068177 0.13650565 0.035389526
36          35 0.528824288 0.29466005 0.14003385 0.036481807
37          36 0.520363100 0.29850133 0.14355751 0.037578062
38          37 0.512037290 0.30220843 0.14707593 0.038678349
39          38 0.503844694 0.30578410 0.15058849 0.039782718
40          39 0.495783178 0.30923107 0.15409453 0.040891220
41          40 0.487850648 0.31255201 0.15759344 0.042003903
42          41 0.480045037 0.31574952 0.16108463 0.043120809
43          42 0.472364317 0.31882619 0.16456751 0.044241983
44          43 0.464806488 0.32178454 0.16804151 0.045367463
45          44 0.457369584 0.32462705 0.17150608 0.046497286
46          45 0.450051670 0.32735616 0.17496068 0.047631488
47          46 0.442850844 0.32997425 0.17840481 0.048770100
48          47 0.435765230 0.33248368 0.18183794 0.049913152
49          48 0.428792987 0.33488675 0.18525959 0.051060673
50          49 0.421932299 0.33718573 0.18866928 0.052212688
51          50 0.415181382 0.33938284 0.19206656 0.053369221
52          51 0.408538480 0.34148026 0.19545097 0.054530293
53          52 0.402001864 0.34348014 0.19882207 0.055695925
54          53 0.395569834 0.34538458 0.20217945 0.056866133
55          54 0.389240717 0.34719565 0.20552270 0.058040934
56          55 0.383012866 0.34891538 0.20885142 0.059220340
57          56 0.376884660 0.35054575 0.21216523 0.060404365
58          57 0.370854505 0.35208873 0.21546375 0.061593018
59          58 0.364920833 0.35354623 0.21874663 0.062786308
60          59 0.359082100 0.35492013 0.22201352 0.063984242
61          60 0.353336786 0.35621230 0.22526409 0.065186825
62          61 0.347683398 0.35742453 0.22849801 0.066394060
63          62 0.342120463 0.35855863 0.23171496 0.067605950
64          63 0.336646536 0.35961632 0.23491465 0.068822494
65          64 0.331260191 0.36059934 0.23809677 0.070043693
66          65 0.325960028 0.36150937 0.24126106 0.071269543
67          66 0.320744668 0.36234806 0.24440723 0.072500041
68          67 0.315612753 0.36311704 0.24753503 0.073735182
69          68 0.310562949 0.36381790 0.25064420 0.074974958
70          69 0.305593942 0.36445220 0.25373449 0.076219362
71          70 0.300704439 0.36502148 0.25680569 0.077468386
72          71 0.295893168 0.36552726 0.25985756 0.078722018
73          72 0.291158877 0.36597099 0.26288988 0.079980248
74          73 0.286500335 0.36635414 0.26590246 0.081243062
75          74 0.281916330 0.36667814 0.26889509 0.082510446
76          75 0.277405668 0.36694437 0.27186757 0.083782387
77          76 0.272967178 0.36715421 0.27481974 0.085058868
78          77 0.268599703 0.36730901 0.27775142 0.086339871
79          78 0.264302108 0.36741008 0.28066244 0.087625380
80          79 0.260073274 0.36745872 0.28355264 0.088915374
81          80 0.255912101 0.36745620 0.28642187 0.090209835
82          81 0.251817508 0.36740376 0.28926999 0.091508740
83          82 0.247788428 0.36730264 0.29209686 0.092812070
84          83 0.243823813 0.36715403 0.29490236 0.094119800
85          84 0.239922632 0.36695911 0.29768635 0.095431908
86          85 0.236083870 0.36671903 0.30044873 0.096748369
87          86 0.232306528 0.36643492 0.30318939 0.098069159
88          87 0.228589623 0.36610790 0.30590822 0.099394251
89          88 0.224932189 0.36573906 0.30860513 0.100723619
90          89 0.221333274 0.36532947 0.31128002 0.102057236
91          90 0.217791942 0.36488016 0.31393282 0.103395074
92          91 0.214307271 0.36439219 0.31656344 0.104737105
93          92 0.210878355 0.36386654 0.31917181 0.106083299
94          93 0.207504301 0.36330421 0.32175786 0.107433626
95          94 0.204184232 0.36270618 0.32432153 0.108788056
96          95 0.200917284 0.36207339 0.32686277 0.110146558
97          96 0.197702608 0.36140677 0.32938152 0.111509100
98          97 0.194539366 0.36070725 0.33187774 0.112875650
99          98 0.191426736 0.35997571 0.33435138 0.114246177
100         99 0.188363908 0.35921303 0.33680241 0.115620645
101        100 0.185350086 0.35842009 0.33923080 0.116999023
102        101 0.182384485 0.35759772 0.34163652 0.118381276
103        102 0.179466333 0.35674675 0.34401955 0.119767368
104        103 0.176594871 0.35586800 0.34637986 0.121157267
105        104 0.173769354 0.35496226 0.34871745 0.122550935
106        105 0.170989044 0.35403032 0.35103230 0.123948338
107        106 0.168253219 0.35307293 0.35332442 0.125349439
108        107 0.165561168 0.35209084 0.35559379 0.126754202
109        108 0.162912189 0.35108481 0.35784041 0.128162590
110        109 0.160305594 0.35005553 0.36006431 0.129574566
111        110 0.157740704 0.34900373 0.36226548 0.130990092
112        111 0.155216853 0.34793008 0.36444393 0.132409131
113        112 0.152733384 0.34683528 0.36659969 0.133831645
114        113 0.150289649 0.34571998 0.36873277 0.135257595
115        114 0.147885015 0.34458484 0.37084320 0.136686943
116        115 0.145518855 0.34343049 0.37293101 0.138119650
117        116 0.143190553 0.34225755 0.37499622 0.139555677
118        117 0.140899504 0.34106665 0.37703886 0.140994985
119        118 0.138645112 0.33985838 0.37905897 0.142437535
120        119 0.136426790 0.33863332 0.38105660 0.143883286
121        120 0.134243962 0.33739206 0.38303178 0.145332199
122        121 0.132096058 0.33613516 0.38498455 0.146784234
123        122 0.129982521 0.33486316 0.38691497 0.148239352
124        123 0.127902801 0.33357661 0.38882307 0.149697511
125        124 0.125856356 0.33227605 0.39070893 0.151158671
126        125 0.123842655 0.33096198 0.39257258 0.152622792
127        126 0.121861172 0.32963491 0.39441408 0.154089833
128        127 0.119911393 0.32829535 0.39623350 0.155559754
129        128 0.117992811 0.32694377 0.39803090 0.157032514
130        129 0.116104926 0.32558067 0.39980634 0.158508071
131        130 0.114247247 0.32420649 0.40155988 0.159986386
132        131 0.112419291 0.32282170 0.40329159 0.161467416
133        132 0.110620583 0.32142675 0.40500155 0.162951121
134        133 0.108850653 0.32002207 0.40668982 0.164437459
135        134 0.107109043 0.31860809 0.40835648 0.165926390
136        135 0.105395298 0.31718523 0.41000160 0.167417873
137        136 0.103708973 0.31575390 0.41162526 0.168911866
138        137 0.102049630 0.31431450 0.41322755 0.170408327
139        138 0.100416836 0.31286742 0.41480853 0.171907217
140        139 0.098810166 0.31141305 0.41636829 0.173408493
141        140 0.097229204 0.30995176 0.41790692 0.174912115
142        141 0.095673536 0.30848392 0.41942450 0.176418040
143        142 0.094142760 0.30700989 0.42092112 0.177926229
144        143 0.092636476 0.30553002 0.42239687 0.179436640
145        144 0.091154292 0.30404465 0.42385182 0.180949233
146        145 0.089695823 0.30255412 0.42528609 0.182463965
147        146 0.088260690 0.30105876 0.42669975 0.183980796
148        147 0.086848519 0.29955889 0.42809290 0.185499685
149        148 0.085458943 0.29805482 0.42946564 0.187020592
150        149 0.084091600 0.29654686 0.43081806 0.188543475
151        150 0.082746134 0.29503532 0.43215026 0.190068294
152        151 0.081422196 0.29352047 0.43346233 0.191595009
153        152 0.080119441 0.29200261 0.43475437 0.193123578
154        153 0.078837530 0.29048202 0.43602649 0.194653962
155        154 0.077576129 0.28895898 0.43727878 0.196186120
156        155 0.076334911 0.28743374 0.43851134 0.197720012
157        156 0.075113553 0.28590657 0.43972428 0.199255598
158        157 0.073911736 0.28437773 0.44091770 0.200792838
159        158 0.072729148 0.28284746 0.44209170 0.202331691
160        159 0.071565482 0.28131600 0.44324640 0.203872119
161        160 0.070420434 0.27978360 0.44438188 0.205414082
162        161 0.069293707 0.27825049 0.44549827 0.206957540
163        162 0.068185008 0.27671688 0.44659566 0.208502454
164        163 0.067094048 0.27518301 0.44767416 0.210048784
165        164 0.066020543 0.27364908 0.44873388 0.211596492
166        165 0.064964214 0.27211531 0.44977494 0.213145539
167        166 0.063924787 0.27058190 0.45079743 0.214695885
168        167 0.062901990 0.26904905 0.45180146 0.216247493
169        168 0.061895558 0.26751696 0.45278716 0.217800324
170        169 0.060905229 0.26598581 0.45375462 0.219354340
171        170 0.059930746 0.26445580 0.45470396 0.220909502
172        171 0.058971854 0.26292709 0.45563528 0.222465772
173        172 0.058028304 0.26139987 0.45654871 0.224023114
174        173 0.057099851 0.25987431 0.45744435 0.225581488
175        174 0.056186254 0.25835058 0.45832231 0.227140858
176        175 0.055287274 0.25682884 0.45918270 0.228701186
177        176 0.054402677 0.25530924 0.46002565 0.230262436
178        177 0.053532234 0.25379194 0.46085125 0.231824570
179        178 0.052675719 0.25227710 0.46165963 0.233387552
180        179 0.051832907 0.25076485 0.46245090 0.234951346
181        180 0.051003581 0.24925534 0.46322516 0.236515914
182        181 0.050187523 0.24774872 0.46398254 0.238081220
183        182 0.049384523 0.24624510 0.46472315 0.239647230
184        183 0.048594371 0.24474463 0.46544709 0.241213906
185        184 0.047816861 0.24324744 0.46615449 0.242781214
186        185 0.047051791 0.24175364 0.46684546 0.244349118
187        186 0.046298962 0.24026335 0.46752010 0.245917583
188        187 0.045558179 0.23877670 0.46817855 0.247486574
189        188 0.044829248 0.23729380 0.46882090 0.249056056
190        189 0.044111980 0.23581475 0.46944727 0.250625995
191        190 0.043406188 0.23433967 0.47005779 0.252196357
192        191 0.042711689 0.23286866 0.47065255 0.253767106
193        192 0.042028302 0.23140181 0.47123168 0.255338210
194        193 0.041355849 0.22993924 0.47179528 0.256909634
195        194 0.040694156 0.22848102 0.47234348 0.258481345
196        195 0.040043049 0.22702726 0.47287638 0.260053310
197        196 0.039402361 0.22557805 0.47339409 0.261625496
198        197 0.038771923 0.22413346 0.47389674 0.263197870
199        198 0.038151572 0.22269359 0.47438444 0.264770399
200        199 0.037541147 0.22125852 0.47485729 0.266343050
201        200 0.036940489 0.21982831 0.47531541 0.267915793
202        201 0.036349441 0.21840306 0.47575891 0.269488593
203        202 0.035767850 0.21698282 0.47618790 0.271061421
204        203 0.035195564 0.21556768 0.47660251 0.272634244
205        204 0.034632435 0.21415771 0.47700283 0.274207031
206        205 0.034078316 0.21275295 0.47738898 0.275779751
207        206 0.033533063 0.21135349 0.47776107 0.277352372
208        207 0.032996534 0.20995939 0.47811921 0.278924866
209        208 0.032468589 0.20857069 0.47846352 0.280497199
210        209 0.031949092 0.20718746 0.47879410 0.282069344
211        210 0.031437907 0.20580976 0.47911107 0.283641269
212        211 0.030934900 0.20443763 0.47941452 0.285212945
213        212 0.030439942 0.20307113 0.47970459 0.286784342
214        213 0.029952903 0.20171030 0.47998136 0.288355432
215        214 0.029473656 0.20035520 0.48024496 0.289926184
216        215 0.029002078 0.19900587 0.48049549 0.291496570
217        216 0.028538044 0.19766234 0.48073305 0.293066561
218        217 0.028081436 0.19632467 0.48095777 0.294636130
219        218 0.027632133 0.19499288 0.48116974 0.296205247
220        219 0.027190019 0.19366703 0.48136907 0.297773885
221        220 0.026754978 0.19234714 0.48155586 0.299342015
222        221 0.026326899 0.19103325 0.48173024 0.300909611
223        222 0.025905668 0.18972539 0.48189230 0.302476646
224        223 0.025491178 0.18842359 0.48204214 0.304043091
225        224 0.025083319 0.18712789 0.48217987 0.305608920
226        225 0.024681986 0.18583830 0.48230561 0.307174107
227        226 0.024287074 0.18455486 0.48241944 0.308738625
228        227 0.023898481 0.18327759 0.48252149 0.310302448
229        228 0.023516105 0.18200651 0.48261184 0.311865550
230        229 0.023139847 0.18074165 0.48269060 0.313427905
231        230 0.022769610 0.17948302 0.48275788 0.314989487
232        231 0.022405296 0.17823065 0.48281378 0.316550272
233        232 0.022046811 0.17698455 0.48285840 0.318110234
234        233 0.021694062 0.17574475 0.48289184 0.319669348
235        234 0.021346957 0.17451124 0.48291421 0.321227590
236        235 0.021005406 0.17328406 0.48292560 0.322784935
237        236 0.020669319 0.17206321 0.48292611 0.324341359
238        237 0.020338610 0.17084871 0.48291584 0.325896839
239        238 0.020013193 0.16964056 0.48289490 0.327451349
240        239 0.019692982 0.16843877 0.48286338 0.329004867
241        240 0.019377894 0.16724336 0.48282138 0.330557370
242        241 0.019067848 0.16605432 0.48276900 0.332108834
243        242 0.018762762 0.16487168 0.48270633 0.333659236
244        243 0.018462558 0.16369542 0.48263347 0.335208553
245        244 0.018167157 0.16252556 0.48255052 0.336756764
246        245 0.017876482 0.16136210 0.48245758 0.338303845
247        246 0.017590459 0.16020504 0.48235473 0.339849776
248        247 0.017309011 0.15905438 0.48224208 0.341394533
249        248 0.017032067 0.15791013 0.48211971 0.342938095
250        249 0.016759554 0.15677227 0.48198773 0.344480441
251        250 0.016491401 0.15564082 0.48184622 0.346021550
252        251 0.016227539 0.15451577 0.48169529 0.347561401
253        252 0.015967898 0.15339712 0.48153501 0.349099972
254        253 0.015712412 0.15228486 0.48136548 0.350637244
255        254 0.015461013 0.15117899 0.48118680 0.352173195
256        255 0.015213637 0.15007950 0.48099906 0.353707806
257        256 0.014970219 0.14898639 0.48080234 0.355241056
258        257 0.014730695 0.14789964 0.48059673 0.356772927
259        258 0.014495004 0.14681927 0.48038233 0.358303398
260        259 0.014263084 0.14574524 0.48015922 0.359832449
261        260 0.014034875 0.14467757 0.47992750 0.361360063
262        261 0.013810317 0.14361622 0.47968724 0.362886219
263        262 0.013589352 0.14256121 0.47943854 0.364410899
264        263 0.013371922 0.14151251 0.47918148 0.365934084
265        264 0.013157971 0.14047012 0.47891615 0.367455757
266        265 0.012947444 0.13943402 0.47864264 0.368975899
267        266 0.012740285 0.13840420 0.47836103 0.370494491
268        267 0.012536440 0.13738065 0.47807140 0.372011516
269        268 0.012335857 0.13636335 0.47777384 0.373526957
270        269 0.012138483 0.13535229 0.47746843 0.375040796
271        270 0.011944268 0.13434746 0.47715526 0.376553016
272        271 0.011753159 0.13334884 0.47683441 0.378063600
273        272 0.011565109 0.13235641 0.47650595 0.379572531
274        273 0.011380067 0.13137016 0.47616998 0.381079792
275        274 0.011197986 0.13039007 0.47582657 0.382585367
276        275 0.011018818 0.12941613 0.47547581 0.384089240
277        276 0.010842517 0.12844832 0.47511777 0.385591394
278        277 0.010669037 0.12748662 0.47475253 0.387091814
279        278 0.010498332 0.12653101 0.47438017 0.388590484
280        279 0.010330359 0.12558148 0.47400077 0.390087388
281        280 0.010165073 0.12463800 0.47361441 0.391582512
282        281 0.010002432 0.12370056 0.47322117 0.393075839
283        282 0.009842393 0.12276914 0.47282112 0.394567355
284        283 0.009684915 0.12184371 0.47241433 0.396057046
285        284 0.009529956 0.12092425 0.47200089 0.397544895
286        285 0.009377477 0.12001076 0.47158088 0.399030890
287        286 0.009227437 0.11910320 0.47115435 0.400515016
288        287 0.009079798 0.11820155 0.47072140 0.401997258
289        288 0.008934521 0.11730579 0.47028208 0.403477603
290        289 0.008791569 0.11641591 0.46983649 0.404956036
291        290 0.008650904 0.11553187 0.46938468 0.406432545
292        291 0.008512490 0.11465366 0.46892673 0.407907116
293        292 0.008376290 0.11378125 0.46846272 0.409379736
294        293 0.008242269 0.11291463 0.46799271 0.410850391
295        294 0.008110393 0.11205376 0.46751678 0.412319068
296        295 0.007980626 0.11119863 0.46703499 0.413785756
297        296 0.007852936 0.11034921 0.46654741 0.415250441
298        297 0.007727289 0.10950548 0.46605412 0.416713111
299        298 0.007603653 0.10866741 0.46555519 0.418173753
300        299 0.007481994 0.10783498 0.46505067 0.419632356
301        300 0.007362283 0.10700816 0.46454065 0.421088907
302        301 0.007244486 0.10618694 0.46402518 0.422543396
303        302 0.007128574 0.10537129 0.46350433 0.423995809
304        303 0.007014517 0.10456117 0.46297817 0.425446136
305        304 0.006902285 0.10375658 0.46244677 0.426894366
306        305 0.006791848 0.10295747 0.46191019 0.428340487
307        306 0.006683179 0.10216384 0.46136850 0.429784488
308        307 0.006576248 0.10137564 0.46082175 0.431226359
309        308 0.006471028 0.10059287 0.46027002 0.432666088
310        309 0.006367491 0.09981548 0.45971336 0.434103666
311        310 0.006265611 0.09904346 0.45915185 0.435539081
312        311 0.006165362 0.09827677 0.45858554 0.436972324
313        312 0.006066716 0.09751541 0.45801449 0.438403384
314        313 0.005969648 0.09675933 0.45743877 0.439832252
315        314 0.005874134 0.09600851 0.45685844 0.441258918
316        315 0.005780148 0.09526293 0.45627356 0.442683371
317        316 0.005687666 0.09452255 0.45568418 0.444105604
318        317 0.005596663 0.09378736 0.45509037 0.445525605
319        318 0.005507116 0.09305733 0.45449219 0.446943367
320        319 0.005419002 0.09233243 0.45388969 0.448358879
321        320 0.005332298 0.09161263 0.45328294 0.449772133
322        321 0.005246982 0.09089791 0.45267199 0.451183121
323        322 0.005163030 0.09018824 0.45205690 0.452591833
324        323 0.005080421 0.08948360 0.45143772 0.453998260
325        324 0.004999135 0.08878395 0.45081452 0.455402396
326        325 0.004919149 0.08808928 0.45018734 0.456804230
327        326 0.004840442 0.08739955 0.44955625 0.458203756
328        327 0.004762995 0.08671474 0.44892130 0.459600965
329        328 0.004686787 0.08603482 0.44828254 0.460995849
330        329 0.004611799 0.08535976 0.44764004 0.462388401
331        330 0.004538010 0.08468955 0.44699383 0.463778613
332        331 0.004465402 0.08402414 0.44634398 0.465166477
333        332 0.004393955 0.08336352 0.44569053 0.466551987
334        333 0.004323652 0.08270766 0.44503355 0.467935134
335        334 0.004254474 0.08205653 0.44437308 0.469315912
336        335 0.004186402 0.08141010 0.44370918 0.470694314
337        336 0.004119420 0.08076835 0.44304189 0.472070333
338        337 0.004053509 0.08013126 0.44237127 0.473443962
339        338 0.003988653 0.07949878 0.44169737 0.474815195
340        339 0.003924834 0.07887091 0.44102023 0.476184026
341        340 0.003862037 0.07824760 0.44033992 0.477550447
342        341 0.003800244 0.07762884 0.43965646 0.478914452
343        342 0.003739440 0.07701460 0.43896992 0.480276036
344        343 0.003679609 0.07640485 0.43828035 0.481635193
345        344 0.003620736 0.07579956 0.43758779 0.482991916
346        345 0.003562804 0.07519871 0.43689228 0.484346200
347        346 0.003505799 0.07460228 0.43619388 0.485698039
348        347 0.003449706 0.07401023 0.43549264 0.487047427
349        348 0.003394511 0.07342254 0.43478859 0.488394360
350        349 0.003340199 0.07283918 0.43408179 0.489738832
351        350 0.003286756 0.07226013 0.43337228 0.491080837
352        351 0.003234167 0.07168536 0.43266010 0.492420370
353        352 0.003182421 0.07111485 0.43194531 0.493757428
354        353 0.003131502 0.07054856 0.43122794 0.495092003
355        354 0.003081398 0.06998647 0.43050804 0.496424093
356        355 0.003032096 0.06942857 0.42978565 0.497753692
357        356 0.002983582 0.06887481 0.42906082 0.499080795
358        357 0.002935845 0.06832517 0.42833358 0.500405398
359        358 0.002888871 0.06777964 0.42760399 0.501727498
360        359 0.002842649 0.06723818 0.42687208 0.503047088
361        360 0.002797167 0.06670077 0.42613790 0.504364166
362        361 0.002752412 0.06616738 0.42540148 0.505678727
363        362 0.002708374 0.06563798 0.42466287 0.506990768
364        363 0.002665040 0.06511256 0.42392212 0.508300284
365        364 0.002622399 0.06459108 0.42317924 0.509607272
366        365 0.002580441 0.06407353 0.42243430 0.510911727</code></pre>
</div>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="do">### Figure  </span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a><span class="co">#Y-axis: Probability</span></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>stm1 <span class="sc">%&gt;%</span> </span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>()<span class="sc">+</span></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(time_steps,S,<span class="at">color=</span><span class="st">"1. Susceptible"</span>))<span class="sc">+</span></span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(time_steps,E,<span class="at">color=</span><span class="st">"2. Exposed"</span>))<span class="sc">+</span></span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(time_steps,A,<span class="at">color=</span><span class="st">"3. Adopted"</span>))<span class="sc">+</span></span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(time_steps,R,<span class="at">color=</span><span class="st">"4. Reduced_weight"</span>))<span class="sc">+</span></span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> scales<span class="sc">::</span>comma)<span class="sc">+</span></span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title=</span><span class="st">"State Transition Model output main scenario"</span>,</span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a>       <span class="at">y    =</span> <span class="st">"Probability of different states"</span>,</span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a>       <span class="at">x    =</span><span class="st">"Days"</span>,</span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a>       <span class="at">color =</span> <span class="st">""</span>) <span class="sc">+</span></span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb13-16"><a href="#cb13-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb13-17"><a href="#cb13-17" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position=</span><span class="st">"bottom"</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="SystemsScience_StateTransition_SEAR_FINAL_Solutions_files/figure-html/unnamed-chunk-1-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Y-axis: Number of people</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>stm1_people <span class="ot">&lt;-</span> stm1</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>stm1_people<span class="sc">$</span>S <span class="ot">&lt;-</span> stm1<span class="sc">$</span>S<span class="sc">*</span><span class="dv">10</span><span class="sc">^</span><span class="dv">4</span></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>stm1_people<span class="sc">$</span>E <span class="ot">&lt;-</span> stm1<span class="sc">$</span>E<span class="sc">*</span><span class="dv">10</span><span class="sc">^</span><span class="dv">4</span></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>stm1_people<span class="sc">$</span>A <span class="ot">&lt;-</span> stm1<span class="sc">$</span>A<span class="sc">*</span><span class="dv">10</span><span class="sc">^</span><span class="dv">4</span></span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>stm1_people<span class="sc">$</span>R <span class="ot">&lt;-</span> stm1<span class="sc">$</span>R<span class="sc">*</span><span class="dv">10</span><span class="sc">^</span><span class="dv">4</span></span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>stm1_people <span class="sc">%&gt;%</span> </span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>()<span class="sc">+</span></span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(time_steps,S,<span class="at">color=</span><span class="st">"1. Susceptible"</span>))<span class="sc">+</span></span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(time_steps,E,<span class="at">color=</span><span class="st">"2. Exposed"</span>))<span class="sc">+</span></span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(time_steps,A,<span class="at">color=</span><span class="st">"3. Adopted"</span>))<span class="sc">+</span></span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(time_steps,R,<span class="at">color=</span><span class="st">"4. Reduced_weight"</span>))<span class="sc">+</span></span>
<span id="cb14-14"><a href="#cb14-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> scales<span class="sc">::</span>comma)<span class="sc">+</span></span>
<span id="cb14-15"><a href="#cb14-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title=</span><span class="st">"State Transition Model output main scenario"</span>,</span>
<span id="cb14-16"><a href="#cb14-16" aria-hidden="true" tabindex="-1"></a>       <span class="at">y    =</span> <span class="st">"Individuals (total)"</span>,</span>
<span id="cb14-17"><a href="#cb14-17" aria-hidden="true" tabindex="-1"></a>       <span class="at">x    =</span><span class="st">"Days"</span>,</span>
<span id="cb14-18"><a href="#cb14-18" aria-hidden="true" tabindex="-1"></a>       <span class="at">color =</span> <span class="st">""</span>) <span class="sc">+</span></span>
<span id="cb14-19"><a href="#cb14-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb14-20"><a href="#cb14-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb14-21"><a href="#cb14-21" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position=</span><span class="st">"bottom"</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="SystemsScience_StateTransition_SEAR_FINAL_Solutions_files/figure-html/unnamed-chunk-1-3.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Exercises: #(1) Modify the code so it is possible to have a 5% background probability of weight reduction (moving from susceptible to reduced weight without the intervention). Let this reduce the probability of transition from susceptible to susceptible to ensure the rows of the transition matrix sum to 1. How does this change the model results? </span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a><span class="co">#Probability of moving from susceptible to adopting a behavior.</span></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a><span class="co">#this is the background weight loss probability (in absence of intervention)</span></span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>p_sr <span class="ot">=</span> <span class="fl">0.05</span>  <span class="co"># Probability of moving from S to R (probability of being in reduced weight state)</span></span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a><span class="co">#keep all other probabilities the same</span></span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate complementary probabilities</span></span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Ensure that the probabilites across the row sum to 1</span></span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a>p_ss <span class="ot">=</span> <span class="dv">1</span> <span class="sc">-</span> p_se <span class="sc">-</span> p_sa <span class="sc">-</span> p_sr  <span class="co"># Probability of staying in S</span></span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a>transition_mat<span class="ot">=</span><span class="fu">matrix</span>(<span class="fu">c</span>(p_ss, p_se, p_sa, p_sr,</span>
<span id="cb15-15"><a href="#cb15-15" aria-hidden="true" tabindex="-1"></a>                        <span class="dv">0</span>,    p_ee, p_ea, p_er,  <span class="co"># Transitions from state S</span></span>
<span id="cb15-16"><a href="#cb15-16" aria-hidden="true" tabindex="-1"></a>                        <span class="dv">0</span>,    <span class="dv">0</span>,    p_aa, p_ar, <span class="co"># Transitions from state A</span></span>
<span id="cb15-17"><a href="#cb15-17" aria-hidden="true" tabindex="-1"></a>                        <span class="dv">0</span>,    <span class="dv">0</span>,       <span class="dv">0</span>, p_rr),       <span class="co"># Transitions from state R</span></span>
<span id="cb15-18"><a href="#cb15-18" aria-hidden="true" tabindex="-1"></a>                <span class="at">byrow =</span> <span class="cn">TRUE</span>,</span>
<span id="cb15-19"><a href="#cb15-19" aria-hidden="true" tabindex="-1"></a>                <span class="at">nrow =</span> <span class="dv">4</span>)</span>
<span id="cb15-20"><a href="#cb15-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-21"><a href="#cb15-21" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(transition_mat) <span class="ot">&lt;-</span> <span class="fu">rownames</span>(transition_mat) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"S"</span>, <span class="st">"E"</span>, <span class="st">"A"</span>, <span class="st">"R"</span>)</span>
<span id="cb15-22"><a href="#cb15-22" aria-hidden="true" tabindex="-1"></a><span class="co">#transition matrix does not depend on time (does not depend on time)</span></span>
<span id="cb15-23"><a href="#cb15-23" aria-hidden="true" tabindex="-1"></a>transition_mat</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      S      E     A     R
S 0.935 0.0120 0.003 5e-02
E 0.000 0.9915 0.008 5e-04
A 0.000 0.0000 0.997 3e-03
R 0.000 0.0000 0.000 1e+00</code></pre>
</div>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co">#check that rows sum to 1</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a><span class="fu">rowSums</span>(transition_mat)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>S E A R 
1 1 1 1 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="do">##  simulate markov-chain</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>stm2 <span class="ot">&lt;-</span> <span class="fu">stm_simulation</span>(<span class="at">initial_state_vec=</span>initial_states, </span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>                      <span class="at">transition_prob_mat=</span>transition_mat, </span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>                      <span class="at">n_cycles =</span> time)</span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>stm2 <span class="ot">&lt;-</span> stm2 <span class="sc">%&gt;%</span> </span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rowid_to_column</span>(<span class="st">"time_steps"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">time_steps=</span>time_steps<span class="dv">-1</span>)</span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a>stm2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    time_steps            S          E          A          R
1            0 9.300000e-01 0.05000000 0.02000000 0.00000000
2            1 8.695500e-01 0.06073500 0.02313000 0.04658500
3            2 8.130293e-01 0.07065335 0.02615514 0.09016226
4            3 7.601823e-01 0.07980915 0.02908099 0.13092751
5            4 7.107705e-01 0.08825296 0.03191277 0.16906378
6            5 6.645704e-01 0.09603206 0.03465536 0.20474217
7            6 6.213733e-01 0.10319063 0.03731336 0.23812267
8            7 5.809841e-01 0.10976999 0.03989107 0.26935487
9            8 5.432201e-01 0.11580875 0.04239251 0.29857863
10           9 5.079108e-01 0.12134302 0.04482146 0.32592472
11          10 4.748966e-01 0.12640653 0.04718147 0.35151540
12          11 4.440283e-01 0.13103084 0.04947587 0.37546497
13          12 4.151665e-01 0.13524541 0.05170778 0.39788033
14          13 3.881807e-01 0.13907783 0.05388011 0.41886140
15          14 3.629489e-01 0.14255383 0.05599564 0.43850161
16          15 3.393572e-01 0.14569751 0.05805693 0.45688832
17          16 3.172990e-01 0.14853137 0.06006641 0.47410321
18          17 2.966746e-01 0.15107644 0.06202636 0.49022262
19          18 2.773907e-01 0.15335239 0.06393892 0.50531797
20          19 2.593603e-01 0.15537758 0.06580609 0.51945600
21          20 2.425019e-01 0.15716919 0.06762977 0.53269912
22          21 2.267393e-01 0.15874328 0.06941174 0.54510569
23          22 2.120012e-01 0.16011483 0.07115367 0.55673026
24          23 1.982212e-01 0.16129787 0.07285713 0.56762384
25          24 1.853368e-01 0.16230549 0.07452361 0.57783412
26          25 1.732899e-01 0.16314994 0.07615449 0.58740568
27          26 1.620260e-01 0.16384264 0.07775110 0.59638021
28          27 1.514944e-01 0.16439429 0.07931466 0.60479669
29          28 1.416472e-01 0.16481487 0.08084636 0.61269155
30          29 1.324401e-01 0.16511371 0.08234728 0.62009886
31          30 1.238315e-01 0.16529953 0.08381847 0.62705046
32          31 1.157825e-01 0.16538046 0.08526090 0.63357615
33          32 1.082566e-01 0.16536412 0.08667551 0.63970374
34          33 1.012199e-01 0.16525760 0.08806317 0.64545928
35          34 9.464065e-02 0.16506755 0.08942470 0.65086710
36          35 8.848901e-02 0.16480017 0.09076089 0.65594994
37          36 8.273722e-02 0.16446123 0.09207247 0.66072907
38          37 7.735930e-02 0.16405616 0.09336016 0.66522438
39          38 7.233095e-02 0.16358999 0.09462460 0.66945446
40          39 6.762944e-02 0.16306745 0.09586644 0.67343667
41          40 6.323352e-02 0.16249293 0.09708627 0.67718728
42          41 5.912334e-02 0.16187054 0.09828466 0.68072146
43          42 5.528033e-02 0.16120412 0.09946214 0.68405341
44          43 5.168711e-02 0.16049725 0.10061922 0.68719642
45          44 4.832744e-02 0.15975327 0.10175641 0.69016288
46          45 4.518616e-02 0.15897530 0.10287414 0.69296440
47          46 4.224906e-02 0.15816624 0.10397288 0.69561182
48          47 3.950287e-02 0.15732882 0.10505304 0.69811527
49          48 3.693518e-02 0.15646555 0.10611502 0.70048424
50          49 3.453440e-02 0.15557882 0.10715921 0.70272758
51          50 3.228966e-02 0.15467081 0.10818596 0.70485356
52          51 3.019083e-02 0.15374359 0.10919564 0.70686994
53          52 2.822843e-02 0.15279906 0.11018857 0.70878394
54          53 2.639358e-02 0.15183901 0.11116509 0.71060233
55          54 2.467800e-02 0.15086510 0.11212548 0.71233142
56          55 2.307393e-02 0.14987888 0.11307006 0.71397713
57          56 2.157412e-02 0.14888180 0.11399911 0.71554498
58          57 2.017181e-02 0.14787519 0.11491288 0.71704012
59          58 1.886064e-02 0.14686031 0.11581166 0.71846739
60          59 1.763470e-02 0.14583833 0.11669569 0.71983128
61          60 1.648844e-02 0.14481032 0.11756522 0.72113602
62          61 1.541669e-02 0.14377729 0.11842047 0.72238555
63          62 1.441461e-02 0.14274019 0.11926168 0.72358353
64          63 1.347766e-02 0.14169987 0.12008906 0.72473342
65          64 1.260161e-02 0.14065715 0.12090282 0.72583842
66          65 1.178251e-02 0.13961279 0.12170317 0.72690154
67          66 1.101664e-02 0.13856747 0.12249031 0.72792558
68          67 1.030056e-02 0.13752184 0.12326443 0.72891316
69          68 9.631025e-03 0.13647651 0.12402572 0.72986675
70          69 9.005008e-03 0.13543204 0.12477434 0.73078861
71          70 8.419682e-03 0.13438892 0.12551049 0.73168090
72          71 7.872403e-03 0.13334765 0.12623433 0.73254561
73          72 7.360697e-03 0.13230867 0.12694603 0.73338461
74          73 6.882252e-03 0.13127237 0.12764574 0.73419964
75          74 6.434905e-03 0.13023914 0.12833363 0.73499232
76          75 6.016636e-03 0.12920933 0.12900985 0.73576419
77          76 5.625555e-03 0.12818325 0.12967454 0.73651665
78          77 5.259894e-03 0.12716120 0.13032786 0.73725105
79          78 4.918001e-03 0.12614345 0.13096995 0.73796861
80          79 4.598331e-03 0.12513025 0.13160094 0.73867049
81          80 4.299439e-03 0.12412182 0.13222097 0.73935777
82          81 4.019976e-03 0.12311838 0.13283018 0.74003147
83          82 3.758677e-03 0.12212011 0.13342870 0.74069252
84          83 3.514363e-03 0.12112719 0.13401665 0.74134180
85          84 3.285930e-03 0.12013978 0.13459416 0.74198013
86          85 3.072344e-03 0.11915803 0.13516135 0.74260828
87          86 2.872642e-03 0.11818205 0.13571835 0.74322696
88          87 2.685920e-03 0.11721198 0.13626527 0.74383683
89          88 2.511335e-03 0.11624791 0.13680223 0.74443853
90          89 2.348099e-03 0.11528993 0.13732934 0.74503263
91          90 2.195472e-03 0.11433815 0.13784671 0.74561967
92          91 2.052766e-03 0.11339262 0.13835446 0.74620015
93          92 1.919337e-03 0.11245341 0.13885270 0.74677455
94          93 1.794580e-03 0.11152059 0.13934153 0.74734330
95          94 1.677932e-03 0.11059420 0.13982105 0.74790681
96          95 1.568866e-03 0.10967429 0.14029138 0.74846547
97          96 1.466890e-03 0.10876088 0.14075260 0.74901963
98          97 1.371542e-03 0.10785402 0.14120483 0.74956961
99          98 1.282392e-03 0.10695372 0.14164816 0.75011573
100         99 1.199037e-03 0.10606000 0.14208270 0.75065827
101        100 1.121099e-03 0.10517288 0.14250853 0.75119750
102        101 1.048228e-03 0.10429236 0.14292575 0.75173366
103        102 9.800929e-04 0.10341845 0.14333445 0.75226700
104        103 9.163869e-04 0.10255116 0.14373474 0.75279772
105        104 8.568217e-04 0.10169047 0.14412669 0.75332602
106        105 8.011283e-04 0.10083638 0.14451041 0.75385208
107        106 7.490550e-04 0.09998889 0.14488597 0.75437609
108        107 7.003664e-04 0.09914797 0.14525347 0.75489819
109        108 6.548426e-04 0.09831362 0.14561299 0.75541855
110        109 6.122778e-04 0.09748581 0.14596463 0.75593728
111        110 5.724798e-04 0.09666453 0.14630846 0.75645453
112        111 5.352686e-04 0.09584975 0.14664457 0.75697042
113        112 5.004761e-04 0.09504145 0.14697304 0.75748504
114        113 4.679452e-04 0.09423960 0.14729395 0.75799850
115        114 4.375287e-04 0.09344418 0.14760739 0.75851090
116        115 4.090894e-04 0.09265516 0.14791343 0.75902232
117        116 3.824986e-04 0.09187250 0.14821216 0.75953284
118        117 3.576362e-04 0.09109617 0.14850365 0.76004254
119        118 3.343898e-04 0.09032614 0.14878798 0.76055148
120        119 3.126545e-04 0.08956238 0.14906523 0.76105973
121        120 2.923319e-04 0.08880486 0.14933547 0.76156734
122        121 2.733304e-04 0.08805352 0.14959878 0.76207436
123        122 2.555639e-04 0.08730835 0.14985523 0.76258085
124        123 2.389522e-04 0.08656929 0.15010490 0.76308685
125        124 2.234203e-04 0.08583632 0.15034786 0.76359240
126        125 2.088980e-04 0.08510939 0.15058418 0.76409753
127        126 1.953196e-04 0.08438847 0.15081393 0.76460228
128        127 1.826239e-04 0.08367351 0.15103718 0.76510669
129        128 1.707533e-04 0.08296448 0.15125400 0.76561077
130        129 1.596543e-04 0.08226133 0.15146447 0.76611455
131        130 1.492768e-04 0.08156403 0.15166864 0.76661805
132        131 1.395738e-04 0.08087252 0.15186660 0.76712131
133        132 1.305015e-04 0.08018678 0.15205840 0.76762432
134        133 1.220189e-04 0.07950676 0.15224411 0.76812711
135        134 1.140877e-04 0.07883242 0.15242380 0.76862970
136        135 1.066720e-04 0.07816371 0.15259753 0.76913209
137        136 9.973832e-05 0.07750060 0.15276536 0.76963430
138        137 9.325532e-05 0.07684304 0.15292737 0.77013633
139        138 8.719373e-05 0.07619099 0.15308361 0.77063820
140        139 8.152614e-05 0.07554442 0.15323415 0.77113991
141        140 7.622694e-05 0.07490327 0.15337905 0.77164146
142        141 7.127219e-05 0.07426750 0.15351837 0.77214286
143        142 6.663949e-05 0.07363709 0.15365217 0.77264411
144        143 6.230793e-05 0.07301197 0.15378051 0.77314522
145        144 5.825791e-05 0.07239212 0.15390345 0.77364618
146        145 5.447115e-05 0.07177748 0.15402105 0.77414700
147        146 5.093052e-05 0.07116803 0.15413337 0.77464767
148        147 4.762004e-05 0.07056371 0.15424047 0.77514821
149        148 4.452474e-05 0.06996449 0.15434240 0.77564859
150        149 4.163063e-05 0.06937033 0.15443922 0.77614883
151        150 3.892464e-05 0.06878118 0.15453099 0.77664891
152        151 3.639454e-05 0.06819700 0.15461776 0.77714884
153        152 3.402889e-05 0.06761777 0.15469959 0.77764861
154        153 3.181701e-05 0.06704342 0.15477654 0.77814822
155        154 2.974891e-05 0.06647394 0.15484865 0.77864766
156        155 2.781523e-05 0.06590927 0.15491599 0.77914693
157        156 2.600724e-05 0.06534937 0.15497860 0.77964603
158        157 2.431677e-05 0.06479421 0.15503653 0.78014494
159        158 2.273618e-05 0.06424375 0.15508985 0.78064366
160        159 2.125833e-05 0.06369795 0.15513860 0.78114219
161        160 1.987654e-05 0.06315678 0.15518283 0.78164052
162        161 1.858456e-05 0.06262018 0.15522260 0.78213864
163        162 1.737656e-05 0.06208813 0.15525795 0.78263654
164        163 1.624709e-05 0.06156059 0.15528893 0.78313423
165        164 1.519103e-05 0.06103752 0.15531560 0.78363169
166        165 1.420361e-05 0.06051889 0.15533799 0.78412891
167        166 1.328038e-05 0.06000465 0.15535617 0.78462590
168        167 1.241715e-05 0.05949477 0.15537018 0.78512263
169        168 1.161004e-05 0.05898921 0.15538007 0.78561911
170        169 1.085538e-05 0.05848794 0.15538588 0.78611533
171        170 1.014978e-05 0.05799092 0.15538765 0.78661127
172        171 9.490048e-06 0.05749812 0.15538545 0.78710694
173        172 8.873195e-06 0.05700950 0.15537931 0.78760232
174        173 8.296437e-06 0.05652503 0.15536927 0.78809740
175        174 7.757169e-06 0.05604467 0.15535539 0.78859219
176        175 7.252953e-06 0.05556838 0.15533770 0.78908666
177        176 6.781511e-06 0.05509613 0.15531626 0.78958082
178        177 6.340713e-06 0.05462790 0.15529110 0.79007466
179        178 5.928566e-06 0.05416364 0.15526227 0.79056816
180        179 5.543210e-06 0.05370332 0.15522981 0.79106133
181        180 5.182901e-06 0.05324691 0.15519376 0.79155415
182        181 4.846012e-06 0.05279437 0.15515417 0.79204661
183        182 4.531022e-06 0.05234568 0.15511108 0.79253871
184        183 4.236505e-06 0.05190079 0.15506452 0.79303045
185        184 3.961132e-06 0.05145969 0.15501455 0.79352180
186        185 3.703659e-06 0.05102233 0.15496120 0.79401277
187        186 3.462921e-06 0.05058868 0.15490450 0.79450335
188        187 3.237831e-06 0.05015872 0.15484451 0.79499354
189        188 3.027372e-06 0.04973241 0.15478125 0.79548331
190        189 2.830593e-06 0.04930972 0.15471478 0.79597267
191        190 2.646604e-06 0.04889062 0.15464512 0.79646161
192        191 2.474575e-06 0.04847508 0.15457232 0.79695012
193        192 2.313728e-06 0.04806307 0.15449641 0.79743820
194        193 2.163335e-06 0.04765457 0.15441743 0.79792584
195        194 2.022719e-06 0.04724953 0.15433542 0.79841303
196        195 1.891242e-06 0.04684793 0.15425042 0.79889976
197        196 1.768311e-06 0.04644975 0.15416246 0.79938603
198        197 1.653371e-06 0.04605494 0.15407157 0.79987183
199        198 1.545902e-06 0.04566350 0.15397780 0.80035715
200        199 1.445418e-06 0.04527538 0.15388118 0.80084200
201        200 1.351466e-06 0.04489055 0.15378174 0.80132635
202        201 1.263621e-06 0.04450900 0.15367953 0.80181021
203        202 1.181485e-06 0.04413069 0.15357457 0.80229357
204        203 1.104689e-06 0.04375559 0.15346689 0.80277641
205        204 1.032884e-06 0.04338368 0.15335654 0.80325875
206        205 9.657466e-07 0.04301493 0.15324354 0.80374056
207        206 9.029730e-07 0.04264932 0.15312793 0.80422185
208        207 8.442798e-07 0.04228681 0.15300975 0.80470260
209        208 7.894016e-07 0.04192738 0.15288901 0.80518281
210        209 7.380905e-07 0.04157101 0.15276577 0.80566248
211        210 6.901146e-07 0.04121766 0.15264004 0.80614160
212        211 6.452572e-07 0.04086732 0.15251186 0.80662017
213        212 6.033155e-07 0.04051996 0.15238127 0.80709817
214        213 5.641000e-07 0.04017555 0.15224829 0.80757560
215        214 5.274335e-07 0.03983406 0.15211295 0.80805246
216        215 4.931503e-07 0.03949548 0.15197528 0.80852875
217        216 4.610955e-07 0.03915977 0.15183532 0.80900444
218        217 4.311243e-07 0.03882692 0.15169310 0.80947955
219        218 4.031012e-07 0.03849689 0.15154863 0.80995407
220        219 3.768996e-07 0.03816968 0.15140196 0.81042798
221        220 3.524012e-07 0.03784524 0.15125312 0.81090129
222        221 3.294951e-07 0.03752356 0.15110212 0.81137399
223        222 3.080779e-07 0.03720461 0.15094900 0.81184608
224        223 2.880528e-07 0.03688838 0.15079379 0.81231754
225        224 2.693294e-07 0.03657483 0.15063652 0.81278838
226        225 2.518230e-07 0.03626395 0.15047721 0.81325859
227        226 2.354545e-07 0.03595571 0.15031589 0.81372817
228        227 2.201500e-07 0.03565008 0.15015259 0.81419711
229        228 2.058402e-07 0.03534706 0.14998733 0.81466540
230        229 1.924606e-07 0.03504661 0.14982015 0.81513304
231        230 1.799507e-07 0.03474872 0.14965106 0.81560004
232        231 1.682539e-07 0.03445336 0.14948010 0.81606637
233        232 1.573174e-07 0.03416051 0.14930729 0.81653205
234        233 1.470917e-07 0.03387014 0.14913265 0.81699706
235        234 1.375308e-07 0.03358225 0.14895621 0.81746140
236        235 1.285913e-07 0.03329680 0.14877800 0.81792507
237        236 1.202328e-07 0.03301378 0.14859804 0.81838806
238        237 1.124177e-07 0.03273317 0.14841636 0.81885036
239        238 1.051106e-07 0.03245493 0.14823298 0.81931198
240        239 9.827837e-08 0.03217907 0.14804792 0.81977292
241        240 9.189028e-08 0.03190555 0.14786121 0.82023315
242        241 8.591741e-08 0.03163435 0.14767287 0.82069270
243        242 8.033278e-08 0.03136546 0.14748292 0.82115154
244        243 7.511115e-08 0.03109886 0.14729140 0.82160967
245        244 7.022892e-08 0.03083452 0.14709832 0.82206710
246        245 6.566404e-08 0.03057242 0.14690370 0.82252381
247        246 6.139588e-08 0.03031256 0.14670757 0.82297981
248        247 5.740515e-08 0.03005490 0.14650994 0.82343510
249        248 5.367381e-08 0.02979944 0.14631085 0.82388966
250        249 5.018501e-08 0.02954614 0.14611032 0.82434349
251        250 4.692299e-08 0.02929500 0.14590835 0.82479660
252        251 4.387299e-08 0.02904599 0.14570499 0.82524897
253        252 4.102125e-08 0.02879910 0.14550024 0.82570061
254        253 3.835487e-08 0.02855431 0.14529413 0.82615152
255        254 3.586180e-08 0.02831160 0.14508669 0.82660168
256        255 3.353079e-08 0.02807095 0.14487792 0.82705109
257        256 3.135128e-08 0.02783235 0.14466785 0.82749977
258        257 2.931345e-08 0.02759577 0.14445651 0.82794769
259        258 2.740808e-08 0.02736121 0.14424391 0.82839486
260        259 2.562655e-08 0.02712864 0.14403006 0.82884127
261        260 2.396083e-08 0.02689805 0.14381500 0.82928693
262        261 2.240337e-08 0.02666941 0.14359874 0.82973182
263        262 2.094715e-08 0.02644272 0.14338130 0.83017595
264        263 1.958559e-08 0.02621796 0.14316270 0.83061932
265        264 1.831252e-08 0.02599511 0.14294296 0.83106192
266        265 1.712221e-08 0.02577415 0.14272209 0.83150374
267        266 1.600927e-08 0.02555507 0.14250011 0.83194480
268        267 1.496866e-08 0.02533785 0.14227705 0.83238508
269        268 1.399570e-08 0.02512248 0.14205293 0.83282458
270        269 1.308598e-08 0.02490894 0.14182775 0.83326330
271        270 1.223539e-08 0.02469722 0.14160154 0.83370124
272        271 1.144009e-08 0.02448729 0.14137431 0.83413839
273        272 1.069649e-08 0.02427915 0.14114608 0.83457476
274        273 1.000121e-08 0.02407277 0.14091688 0.83501034
275        274 9.351135e-09 0.02386816 0.14068671 0.83544512
276        275 8.743311e-09 0.02366528 0.14045560 0.83587912
277        276 8.174996e-09 0.02346412 0.14022355 0.83631232
278        277 7.643621e-09 0.02326468 0.13999059 0.83674472
279        278 7.146786e-09 0.02306693 0.13975674 0.83717633
280        279 6.682245e-09 0.02287086 0.13952200 0.83760713
281        280 6.247899e-09 0.02267646 0.13928641 0.83803713
282        281 5.841785e-09 0.02248371 0.13904996 0.83846633
283        282 5.462069e-09 0.02229260 0.13881268 0.83889472
284        283 5.107035e-09 0.02210311 0.13857458 0.83932231
285        284 4.775078e-09 0.02191523 0.13833568 0.83974908
286        285 4.464698e-09 0.02172895 0.13809600 0.84017505
287        286 4.174492e-09 0.02154426 0.13785554 0.84060020
288        287 3.903150e-09 0.02136113 0.13761433 0.84102454
289        288 3.649445e-09 0.02117956 0.13737237 0.84144806
290        289 3.412232e-09 0.02099953 0.13712969 0.84187077
291        290 3.190436e-09 0.02082104 0.13688630 0.84229266
292        291 2.983058e-09 0.02064406 0.13664221 0.84271373
293        292 2.789159e-09 0.02046859 0.13639744 0.84313398
294        293 2.607864e-09 0.02029460 0.13615199 0.84355340
295        294 2.438353e-09 0.02012210 0.13590589 0.84397201
296        295 2.279860e-09 0.01995106 0.13565915 0.84438979
297        296 2.131669e-09 0.01978148 0.13541178 0.84480674
298        297 1.993111e-09 0.01961333 0.13516380 0.84522286
299        298 1.863558e-09 0.01944662 0.13491521 0.84563816
300        299 1.742427e-09 0.01928132 0.13466604 0.84605263
301        300 1.629169e-09 0.01911743 0.13441629 0.84646627
302        301 1.523273e-09 0.01895493 0.13416599 0.84687908
303        302 1.424261e-09 0.01879382 0.13391513 0.84729105
304        303 1.331684e-09 0.01863407 0.13366373 0.84770220
305        304 1.245124e-09 0.01847568 0.13341181 0.84811250
306        305 1.164191e-09 0.01831864 0.13315938 0.84852198
307        306 1.088519e-09 0.01816293 0.13290645 0.84893062
308        307 1.017765e-09 0.01800854 0.13265304 0.84933842
309        308 9.516102e-10 0.01785547 0.13239915 0.84974538
310        309 8.897556e-10 0.01770370 0.13214479 0.85015151
311        310 8.319214e-10 0.01755322 0.13188999 0.85055679
312        311 7.778466e-10 0.01740402 0.13163474 0.85096124
313        312 7.272865e-10 0.01725608 0.13137907 0.85136484
314        313 6.800129e-10 0.01710941 0.13112298 0.85176761
315        314 6.358121e-10 0.01696398 0.13086649 0.85216953
316        315 5.944843e-10 0.01681978 0.13060960 0.85257061
317        316 5.558428e-10 0.01667681 0.13035233 0.85297085
318        317 5.197130e-10 0.01653506 0.13009469 0.85337025
319        318 4.859317e-10 0.01639451 0.12983669 0.85376880
320        319 4.543461e-10 0.01625516 0.12957833 0.85416651
321        320 4.248136e-10 0.01611699 0.12931964 0.85456337
322        321 3.972007e-10 0.01598000 0.12906062 0.85495939
323        322 3.713827e-10 0.01584417 0.12880127 0.85535456
324        323 3.472428e-10 0.01570949 0.12854162 0.85574889
325        324 3.246720e-10 0.01557596 0.12828167 0.85614237
326        325 3.035683e-10 0.01544356 0.12802144 0.85653500
327        326 2.838364e-10 0.01531229 0.12776092 0.85692678
328        327 2.653870e-10 0.01518214 0.12750014 0.85731772
329        328 2.481369e-10 0.01505309 0.12723909 0.85770781
330        329 2.320080e-10 0.01492514 0.12697780 0.85809706
331        330 2.169275e-10 0.01479828 0.12671627 0.85848545
332        331 2.028272e-10 0.01467249 0.12645451 0.85887300
333        332 1.896434e-10 0.01454778 0.12619252 0.85925970
334        333 1.773166e-10 0.01442412 0.12593033 0.85964555
335        334 1.657910e-10 0.01430151 0.12566793 0.86003056
336        335 1.550146e-10 0.01417995 0.12540534 0.86041471
337        336 1.449386e-10 0.01405942 0.12514256 0.86079802
338        337 1.355176e-10 0.01393992 0.12487961 0.86118047
339        338 1.267090e-10 0.01382143 0.12461649 0.86156208
340        339 1.184729e-10 0.01370395 0.12435321 0.86194284
341        340 1.107722e-10 0.01358746 0.12408978 0.86232276
342        341 1.035720e-10 0.01347197 0.12382621 0.86270182
343        342 9.683980e-11 0.01335746 0.12356251 0.86308003
344        343 9.054521e-11 0.01324392 0.12329868 0.86345740
345        344 8.465977e-11 0.01313134 0.12303474 0.86383392
346        345 7.915689e-11 0.01301973 0.12277068 0.86420959
347        346 7.401169e-11 0.01290906 0.12250653 0.86458441
348        347 6.920093e-11 0.01279933 0.12224228 0.86495838
349        348 6.470287e-11 0.01269054 0.12197795 0.86533151
350        349 6.049718e-11 0.01258267 0.12171354 0.86570379
351        350 5.656486e-11 0.01247572 0.12144906 0.86607522
352        351 5.288815e-11 0.01236967 0.12118452 0.86644581
353        352 4.945042e-11 0.01226453 0.12091992 0.86681554
354        353 4.623614e-11 0.01216028 0.12065528 0.86718444
355        354 4.323079e-11 0.01205692 0.12039060 0.86755248
356        355 4.042079e-11 0.01195444 0.12012588 0.86791968
357        356 3.779344e-11 0.01185282 0.11986114 0.86828604
358        357 3.533687e-11 0.01175207 0.11959638 0.86865155
359        358 3.303997e-11 0.01165218 0.11933161 0.86901621
360        359 3.089237e-11 0.01155314 0.11906683 0.86938003
361        360 2.888437e-11 0.01145494 0.11880205 0.86974301
362        361 2.700688e-11 0.01135757 0.11853729 0.87010514
363        362 2.525144e-11 0.01126103 0.11827253 0.87046643
364        363 2.361009e-11 0.01116531 0.11800781 0.87082688
365        364 2.207544e-11 0.01107041 0.11774310 0.87118649
366        365 2.064053e-11 0.01097631 0.11747844 0.87154525</code></pre>
</div>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="do">### Figure  </span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a><span class="co">#Y-axis: Probability</span></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>stm2 <span class="sc">%&gt;%</span> </span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>()<span class="sc">+</span></span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(time_steps,S,<span class="at">color=</span><span class="st">"1. Susceptible"</span>))<span class="sc">+</span></span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(time_steps,E,<span class="at">color=</span><span class="st">"2. Exposed"</span>))<span class="sc">+</span></span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(time_steps,A,<span class="at">color=</span><span class="st">"3. Adopted"</span>))<span class="sc">+</span></span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(time_steps,R,<span class="at">color=</span><span class="st">"4. Reduced_weight"</span>))<span class="sc">+</span></span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> scales<span class="sc">::</span>comma)<span class="sc">+</span></span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title=</span><span class="st">"State Transition Model output 5% background weight reduction"</span>,</span>
<span id="cb21-12"><a href="#cb21-12" aria-hidden="true" tabindex="-1"></a>       <span class="at">y    =</span> <span class="st">"Probability of different states"</span>,</span>
<span id="cb21-13"><a href="#cb21-13" aria-hidden="true" tabindex="-1"></a>       <span class="at">x    =</span><span class="st">"Days"</span>,</span>
<span id="cb21-14"><a href="#cb21-14" aria-hidden="true" tabindex="-1"></a>       <span class="at">color =</span> <span class="st">""</span>) <span class="sc">+</span></span>
<span id="cb21-15"><a href="#cb21-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb21-16"><a href="#cb21-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb21-17"><a href="#cb21-17" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position=</span><span class="st">"bottom"</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="SystemsScience_StateTransition_SEAR_FINAL_Solutions_files/figure-html/unnamed-chunk-2-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Solution: The recovered curve increases much more quickly, while a small proportion of the population exposed or adopted the intervention.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="co">#(2) Using the original transition probabilities (rerun example code above for these settings), modify the code so that there are 10% exposed and 5% adopted initially in the model. How does this change the model results? </span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a><span class="co">#Rerun main scenario example code</span></span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>p_se <span class="ot">=</span> <span class="fl">0.012</span>  <span class="co"># Probability of moving from S to E (probability of being exposed to an intervention)</span></span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a><span class="co">#Probability of moving from susceptible to exposed.</span></span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>p_sa <span class="ot">=</span> <span class="fl">0.003</span>  <span class="co"># Probability of moving from S to A (probability of adopting a behavior)</span></span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a><span class="co">#Probability of moving from susceptible to adopting a behavior.</span></span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a>p_sr <span class="ot">=</span> <span class="fl">0.001</span>  <span class="co"># Probability of moving from S to R (probability of being in reduced weight state)</span></span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a><span class="co">#Probability of moving from susceptible to reduced weight.</span></span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a>p_ea <span class="ot">=</span> <span class="fl">0.008</span>  <span class="co"># Probability of moving from E to A (probability of adopting a behavior)</span></span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true" tabindex="-1"></a><span class="co">#Probability of mving from exposed to adopted behavior</span></span>
<span id="cb23-12"><a href="#cb23-12" aria-hidden="true" tabindex="-1"></a>p_er <span class="ot">=</span> <span class="fl">0.0005</span> <span class="co"># Probability of moving from E to R (probability of having a reduced weight)</span></span>
<span id="cb23-13"><a href="#cb23-13" aria-hidden="true" tabindex="-1"></a><span class="co">#Probability of moving from exposed  to reduced weight</span></span>
<span id="cb23-14"><a href="#cb23-14" aria-hidden="true" tabindex="-1"></a>p_ar <span class="ot">=</span> <span class="fl">0.003</span>  <span class="co"># Probability of moving from A to R (probability of having a reduced weight)</span></span>
<span id="cb23-15"><a href="#cb23-15" aria-hidden="true" tabindex="-1"></a><span class="co">#Probability of moving from behavior adopted to reduced weight</span></span>
<span id="cb23-16"><a href="#cb23-16" aria-hidden="true" tabindex="-1"></a>p_rr <span class="ot">=</span> <span class="dv">1</span>      <span class="co"># Probability of staying in the reduced weight state (must be one, absorbing state)</span></span>
<span id="cb23-17"><a href="#cb23-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-18"><a href="#cb23-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate complementary probabilities</span></span>
<span id="cb23-19"><a href="#cb23-19" aria-hidden="true" tabindex="-1"></a>p_ss <span class="ot">=</span> <span class="dv">1</span> <span class="sc">-</span> p_se <span class="sc">-</span> p_sa <span class="sc">-</span> p_sr  <span class="co"># Probability of staying in S</span></span>
<span id="cb23-20"><a href="#cb23-20" aria-hidden="true" tabindex="-1"></a>p_ee <span class="ot">=</span> <span class="dv">1</span> <span class="sc">-</span> p_ea <span class="sc">-</span> p_er         <span class="co"># Probability of staying in E</span></span>
<span id="cb23-21"><a href="#cb23-21" aria-hidden="true" tabindex="-1"></a>p_aa <span class="ot">=</span> <span class="dv">1</span> <span class="sc">-</span> p_ar                <span class="co"># Probability of staying in A</span></span>
<span id="cb23-22"><a href="#cb23-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-23"><a href="#cb23-23" aria-hidden="true" tabindex="-1"></a>transition_mat<span class="ot">=</span><span class="fu">matrix</span>(<span class="fu">c</span>(p_ss, p_se, p_sa, p_sr,</span>
<span id="cb23-24"><a href="#cb23-24" aria-hidden="true" tabindex="-1"></a>                        <span class="dv">0</span>,    p_ee, p_ea, p_er,  <span class="co"># Transitions from state S</span></span>
<span id="cb23-25"><a href="#cb23-25" aria-hidden="true" tabindex="-1"></a>                        <span class="dv">0</span>,    <span class="dv">0</span>,    p_aa, p_ar,  <span class="co"># Transitions from state A</span></span>
<span id="cb23-26"><a href="#cb23-26" aria-hidden="true" tabindex="-1"></a>                        <span class="dv">0</span>,    <span class="dv">0</span>,       <span class="dv">0</span>, p_rr), <span class="co"># Transitions from state R</span></span>
<span id="cb23-27"><a href="#cb23-27" aria-hidden="true" tabindex="-1"></a>                <span class="at">byrow =</span> <span class="cn">TRUE</span>,</span>
<span id="cb23-28"><a href="#cb23-28" aria-hidden="true" tabindex="-1"></a>                <span class="at">nrow =</span> <span class="dv">4</span>)</span>
<span id="cb23-29"><a href="#cb23-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-30"><a href="#cb23-30" aria-hidden="true" tabindex="-1"></a><span class="co">#transition matrix does not depend on time (does not depend on time)</span></span>
<span id="cb23-31"><a href="#cb23-31" aria-hidden="true" tabindex="-1"></a>transition_mat</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      [,1]   [,2]  [,3]  [,4]
[1,] 0.984 0.0120 0.003 1e-03
[2,] 0.000 0.9915 0.008 5e-04
[3,] 0.000 0.0000 0.997 3e-03
[4,] 0.000 0.0000 0.000 1e+00</code></pre>
</div>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="co">#check that rows sum to 1</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a><span class="fu">rowSums</span>(transition_mat)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1 1 1 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(transition_mat) <span class="ot">&lt;-</span> <span class="fu">rownames</span>(transition_mat) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"S"</span>, <span class="st">"E"</span>, <span class="st">"A"</span>, <span class="st">"R"</span>)</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a><span class="do">##  simulate markov-chain</span></span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>time <span class="ot">=</span> <span class="dv">365</span>     <span class="co">#day intervals</span></span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a>transition_mat <span class="co">#time invariant</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      S      E     A     R
S 0.984 0.0120 0.003 1e-03
E 0.000 0.9915 0.008 5e-04
A 0.000 0.0000 0.997 3e-03
R 0.000 0.0000 0.000 1e+00</code></pre>
</div>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="co">#P(E)=0.10 initially exposed and P(A)=0.05 initially adopted</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a><span class="co">#Ensure the probabilities sum to one by reducing the proportion in the S state</span></span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>initial_states <span class="ot">=</span> <span class="fu">c</span>(<span class="at">S=</span><span class="fl">0.85</span>,<span class="at">E=</span><span class="fl">0.10</span>,<span class="at">A=</span><span class="fl">0.05</span>, <span class="at">R=</span><span class="dv">0</span>)</span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a>stm3 <span class="ot">&lt;-</span> <span class="fu">stm_simulation</span>(<span class="at">initial_state_vec=</span>initial_states, </span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a>                      <span class="at">transition_prob_mat=</span>transition_mat, </span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a>                      <span class="at">n_cycles =</span> time)</span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-10"><a href="#cb29-10" aria-hidden="true" tabindex="-1"></a>stm3 <span class="ot">&lt;-</span> stm3 <span class="sc">%&gt;%</span> </span>
<span id="cb29-11"><a href="#cb29-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb29-12"><a href="#cb29-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rowid_to_column</span>(<span class="st">"time_steps"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb29-13"><a href="#cb29-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">time_steps=</span>time_steps<span class="dv">-1</span>)</span>
<span id="cb29-14"><a href="#cb29-14" aria-hidden="true" tabindex="-1"></a>stm3</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    time_steps           S          E          A           R
1            0 0.850000000 0.10000000 0.05000000 0.000000000
2            1 0.836400000 0.10935000 0.05320000 0.001050000
3            2 0.823017600 0.11845733 0.05642440 0.002100675
4            3 0.809849318 0.12732665 0.05967184 0.003152194
5            4 0.796891729 0.13596256 0.06294098 0.004204723
6            5 0.784141462 0.14436958 0.06623054 0.005258419
7            6 0.771595198 0.15255214 0.06953923 0.006313436
8            7 0.759249675 0.16051459 0.07286581 0.007369925
9            8 0.747101680 0.16826121 0.07620908 0.008428030
10           9 0.735148053 0.17579621 0.07956785 0.009487889
11          10 0.723385685 0.18312372 0.08294096 0.010549639
12          11 0.711811514 0.19024780 0.08632728 0.011613409
13          12 0.700422529 0.19717243 0.08972572 0.012679327
14          13 0.689215769 0.20390153 0.09313519 0.013747513
15          14 0.678188317 0.21043896 0.09655464 0.014818085
16          15 0.667337304 0.21678849 0.09998305 0.015891156
17          16 0.656659907 0.22295383 0.10341942 0.016966837
18          17 0.646153348 0.22893864 0.10686278 0.018045232
19          18 0.635814895 0.23474651 0.11031216 0.019126443
20          19 0.625641856 0.24038094 0.11376664 0.020210568
21          20 0.615631587 0.24584540 0.11722531 0.021297700
22          21 0.605781481 0.25114330 0.12068729 0.022387930
23          22 0.596088977 0.25627796 0.12415172 0.023481345
24          23 0.586551554 0.26125266 0.12761776 0.024578028
25          24 0.577166729 0.26607063 0.13108458 0.025678060
26          25 0.567932061 0.27073503 0.13455139 0.026781515
27          26 0.558845148 0.27524897 0.13801741 0.027888469
28          27 0.549903626 0.27961550 0.14148189 0.028998991
29          28 0.541105168 0.28383761 0.14494408 0.030113148
30          29 0.532447485 0.28791825 0.14840326 0.031231004
31          30 0.523928326 0.29186031 0.15185874 0.032352621
32          31 0.515545472 0.29566664 0.15530983 0.033478055
33          32 0.507296745 0.29934002 0.15875587 0.034607364
34          33 0.499179997 0.30288319 0.16219621 0.035740598
35          34 0.491193117 0.30629884 0.16563023 0.036877808
36          35 0.483334027 0.30958962 0.16905731 0.038019041
37          36 0.475600683 0.31275812 0.17247686 0.039164342
38          37 0.467991072 0.31580688 0.17588829 0.040313752
39          38 0.460503215 0.31873842 0.17929106 0.041467312
40          39 0.453135163 0.32155518 0.18268460 0.042625057
41          40 0.445885000 0.32425958 0.18606839 0.043787024
42          41 0.438750840 0.32685400 0.18944192 0.044953244
43          42 0.431730827 0.32934075 0.19280468 0.046123748
44          43 0.424823134 0.33172212 0.19615618 0.047298563
45          44 0.418025964 0.33400036 0.19949596 0.048477716
46          45 0.411337548 0.33617767 0.20282355 0.049661230
47          46 0.404756147 0.33825621 0.20613852 0.050849127
48          47 0.398280049 0.34023810 0.20944042 0.052041426
49          48 0.391907568 0.34212544 0.21272884 0.053238147
50          49 0.385637047 0.34392027 0.21600338 0.054439304
51          50 0.379466854 0.34562459 0.21926365 0.055644911
52          51 0.373395385 0.34724038 0.22250925 0.056854981
53          52 0.367421059 0.34876958 0.22573983 0.058069524
54          53 0.361542322 0.35021409 0.22895503 0.059288550
55          54 0.355757645 0.35157578 0.23215451 0.060512064
56          55 0.350065522 0.35285648 0.23533793 0.061740073
57          56 0.344464474 0.35405799 0.23850496 0.062972581
58          57 0.338953042 0.35518207 0.24165530 0.064209589
59          58 0.333529794 0.35623046 0.24478865 0.065451099
60          59 0.328193317 0.35720485 0.24790472 0.066697110
61          60 0.322942224 0.35810693 0.25100322 0.067947620
62          61 0.317775148 0.35893833 0.25408390 0.069202625
63          62 0.312690746 0.35970066 0.25714648 0.070462121
64          63 0.307687694 0.36039549 0.26019071 0.071726102
65          64 0.302764691 0.36102438 0.26321637 0.072994559
66          65 0.297920456 0.36158885 0.26622321 0.074267485
67          66 0.293153729 0.36209039 0.26921101 0.075544870
68          67 0.288463269 0.36253047 0.27217956 0.076826702
69          68 0.283847857 0.36291052 0.27512866 0.078112969
70          69 0.279306291 0.36323195 0.27805810 0.079403658
71          70 0.274837390 0.36349616 0.28096770 0.080698755
72          71 0.270439992 0.36370449 0.28385728 0.081998243
73          72 0.266112952 0.36385828 0.28672666 0.083302107
74          73 0.261855145 0.36395884 0.28957569 0.084610329
75          74 0.257665463 0.36400745 0.29240420 0.085922891
76          75 0.253542815 0.36400537 0.29521204 0.087239773
77          76 0.249486130 0.36395384 0.29799908 0.088560954
78          77 0.245494352 0.36385407 0.30076517 0.089886415
79          78 0.241566442 0.36370724 0.30351019 0.091216132
80          79 0.237701379 0.36351452 0.30623401 0.092550082
81          80 0.233898157 0.36327707 0.30893653 0.093888243
82          81 0.230155787 0.36299599 0.31161763 0.095230589
83          82 0.226473294 0.36267239 0.31427722 0.096577096
84          83 0.222849721 0.36230736 0.31691518 0.097927737
85          84 0.219284126 0.36190194 0.31953145 0.099282486
86          85 0.215775580 0.36145719 0.32212592 0.100641315
87          86 0.212323171 0.36097411 0.32469853 0.102004197
88          87 0.208926000 0.36045370 0.32724919 0.103371103
89          88 0.205583184 0.35989696 0.32977785 0.104742004
90          89 0.202293853 0.35930483 0.33228444 0.106116869
91          90 0.199057151 0.35867827 0.33476891 0.107495668
92          91 0.195872237 0.35801819 0.33723120 0.108878371
93          92 0.192738281 0.35732550 0.33967127 0.110264946
94          93 0.189654469 0.35660109 0.34208908 0.111655361
95          94 0.186619997 0.35584584 0.34448458 0.113049583
96          95 0.183634077 0.35506059 0.34685775 0.114447580
97          96 0.180695932 0.35424618 0.34920857 0.115849318
98          97 0.177804797 0.35340344 0.35153700 0.117254762
99          98 0.174959920 0.35253317 0.35384303 0.118663880
100         99 0.172160561 0.35163616 0.35612665 0.120076636
101        100 0.169405993 0.35071318 0.35838784 0.121492994
102        101 0.166695497 0.34976499 0.36062660 0.122912920
103        102 0.164028369 0.34879233 0.36284292 0.124336378
104        103 0.161403915 0.34779594 0.36503682 0.125763331
105        104 0.158821452 0.34677652 0.36720829 0.127193744
106        105 0.156280309 0.34573477 0.36935734 0.128627578
107        106 0.153779824 0.34467139 0.37148399 0.130064798
108        107 0.151319347 0.34358704 0.37358824 0.131505365
109        108 0.148898237 0.34248239 0.37567013 0.132949243
110        109 0.146515865 0.34135806 0.37772968 0.134396393
111        110 0.144171612 0.34021471 0.37976690 0.135846777
112        111 0.141864866 0.33905295 0.38178183 0.137300356
113        112 0.139595028 0.33787337 0.38377451 0.138757093
114        113 0.137361508 0.33667659 0.38574495 0.140216949
115        114 0.135163723 0.33546318 0.38769322 0.141679883
116        115 0.133001104 0.33423371 0.38961933 0.143145858
117        116 0.130873086 0.33298873 0.39152335 0.144614834
118        117 0.128779117 0.33172880 0.39340531 0.146086772
119        118 0.126718651 0.33045446 0.39526526 0.147561631
120        119 0.124691152 0.32916622 0.39710325 0.149039373
121        120 0.122696094 0.32786460 0.39891935 0.150519957
122        121 0.120732957 0.32655011 0.40071360 0.152003343
123        122 0.118801229 0.32522322 0.40248605 0.153489492
124        123 0.116900410 0.32388444 0.40423679 0.154978363
125        124 0.115030003 0.32253423 0.40596585 0.156469916
126        125 0.113189523 0.32117305 0.40767332 0.157964111
127        126 0.111378491 0.31980135 0.40935925 0.159460907
128        127 0.109596435 0.31841958 0.41102372 0.160960264
129        128 0.107842892 0.31702817 0.41266679 0.162462141
130        129 0.106117406 0.31562755 0.41428855 0.163966498
131        130 0.104419527 0.31421812 0.41588906 0.165473295
132        131 0.102748815 0.31280030 0.41746839 0.166982491
133        132 0.101104834 0.31137449 0.41902664 0.168494045
134        133 0.099487156 0.30994106 0.42056387 0.170007917
135        134 0.097895362 0.30850041 0.42208016 0.171524066
136        135 0.096329036 0.30705290 0.42357561 0.173042452
137        136 0.094787771 0.30559890 0.42505030 0.174563035
138        137 0.093271167 0.30413876 0.42650430 0.176085773
139        138 0.091778828 0.30267283 0.42793771 0.177610626
140        139 0.090310367 0.30120146 0.42935062 0.179137555
141        140 0.088865401 0.29972497 0.43074311 0.180666518
142        141 0.087443555 0.29824370 0.43211527 0.182197475
143        142 0.086044458 0.29675795 0.43346721 0.183730386
144        143 0.084667747 0.29526804 0.43479900 0.185265211
145        144 0.083313063 0.29377427 0.43611075 0.186801910
146        145 0.081980054 0.29227695 0.43740256 0.188340442
147        146 0.080668373 0.29077635 0.43867450 0.189880768
148        147 0.079377679 0.28927278 0.43992670 0.191422849
149        148 0.078107636 0.28776649 0.44115923 0.192966643
150        149 0.076857914 0.28625777 0.44237221 0.194512111
151        150 0.075628187 0.28474687 0.44356573 0.196059215
152        151 0.074418136 0.28323406 0.44473989 0.197607914
153        152 0.073227446 0.28171959 0.44589480 0.199158168
154        153 0.072055807 0.28020370 0.44703055 0.200709940
155        154 0.070902914 0.27868664 0.44814726 0.202263189
156        155 0.069768467 0.27716864 0.44924502 0.203817877
157        156 0.068652172 0.27564993 0.45032394 0.205373965
158        157 0.067553737 0.27413073 0.45138412 0.206931414
159        158 0.066472877 0.27261126 0.45242568 0.208490186
160        159 0.065409311 0.27109174 0.45344871 0.210050241
161        160 0.064362762 0.26957237 0.45445332 0.211611542
162        161 0.063332958 0.26805336 0.45543963 0.213174051
163        162 0.062319631 0.26653490 0.45640774 0.214737730
164        163 0.061322517 0.26501719 0.45735775 0.216302540
165        164 0.060341356 0.26350042 0.45828978 0.217868444
166        165 0.059375895 0.26198476 0.45920394 0.219435405
167        166 0.058425880 0.26047040 0.46010034 0.221003386
168        167 0.057491066 0.25895751 0.46097908 0.222572348
169        168 0.056571209 0.25744626 0.46184027 0.224142255
170        169 0.055666070 0.25593683 0.46268403 0.225713070
171        170 0.054775413 0.25442936 0.46351048 0.227284756
172        171 0.053899006 0.25292401 0.46431971 0.228857278
173        172 0.053036622 0.25142094 0.46511184 0.230430598
174        173 0.052188036 0.24992031 0.46588698 0.232004681
175        174 0.051353028 0.24842224 0.46664524 0.233579490
176        175 0.050531379 0.24692689 0.46738674 0.235154990
177        176 0.049722877 0.24543439 0.46811159 0.236731145
178        177 0.048927311 0.24394487 0.46881990 0.238307920
179        178 0.048144474 0.24245846 0.46951178 0.239885279
180        179 0.047374162 0.24097530 0.47018735 0.241463188
181        180 0.046616176 0.23949550 0.47084671 0.243041612
182        181 0.045870317 0.23801918 0.47148998 0.244620516
183        182 0.045136392 0.23654646 0.47211728 0.246199866
184        183 0.044414210 0.23507746 0.47272871 0.247779627
185        184 0.043703582 0.23361227 0.47332438 0.249359766
186        185 0.043004325 0.23215101 0.47390442 0.250940249
187        186 0.042316256 0.23069377 0.47446893 0.252521042
188        187 0.041639196 0.22924067 0.47501802 0.254102112
189        188 0.040972969 0.22779180 0.47555181 0.255683426
190        189 0.040317401 0.22634724 0.47607041 0.257264950
191        190 0.039672323 0.22490710 0.47657393 0.258846652
192        191 0.039037566 0.22347146 0.47706248 0.260428500
193        192 0.038412964 0.22204040 0.47753617 0.262010461
194        193 0.037798357 0.22061401 0.47799513 0.263592502
195        194 0.037193583 0.21919237 0.47843945 0.265174593
196        195 0.036598486 0.21777556 0.47886925 0.266756701
197        196 0.036012910 0.21636365 0.47928464 0.268338795
198        197 0.035436704 0.21495672 0.47968574 0.269920844
199        198 0.034869716 0.21355482 0.48007264 0.271502816
200        199 0.034311801 0.21215804 0.48044547 0.273084681
201        200 0.033762812 0.21076644 0.48080434 0.274666409
202        201 0.033222607 0.20938008 0.48114934 0.276247968
203        202 0.032691045 0.20799902 0.48148060 0.277829328
204        203 0.032167989 0.20662332 0.48179823 0.279410461
205        204 0.031653301 0.20525304 0.48210232 0.280991335
206        205 0.031146848 0.20388823 0.48239300 0.282571922
207        206 0.030648498 0.20252894 0.48267037 0.284152192
208        207 0.030158123 0.20117523 0.48293453 0.285732116
209        208 0.029675593 0.19982714 0.48318561 0.287311665
210        209 0.029200783 0.19848471 0.48342369 0.288890811
211        210 0.028733571 0.19714800 0.48364890 0.290469525
212        211 0.028273833 0.19581705 0.48386134 0.292047780
213        212 0.027821452 0.19449189 0.48406111 0.293625546
214        213 0.027376309 0.19317256 0.48424833 0.295202797
215        214 0.026938288 0.19185911 0.48442310 0.296779504
216        215 0.026507275 0.19055157 0.48458551 0.298355641
217        216 0.026083159 0.18924997 0.48473569 0.299931181
218        217 0.025665828 0.18795434 0.48487373 0.301506096
219        218 0.025255175 0.18666472 0.48499974 0.303080360
220        219 0.024851092 0.18538113 0.48511383 0.304653947
221        220 0.024453475 0.18410361 0.48521609 0.306226830
222        221 0.024062219 0.18283217 0.48530663 0.307798984
223        222 0.023677224 0.18156684 0.48538555 0.309370382
224        223 0.023298388 0.18030765 0.48545296 0.310940999
225        224 0.022925614 0.17905461 0.48550896 0.312510811
226        225 0.022558804 0.17780776 0.48555365 0.314079790
227        226 0.022197863 0.17656710 0.48558713 0.315647914
228        227 0.021842697 0.17533265 0.48560950 0.317215157
229        228 0.021493214 0.17410444 0.48562086 0.318781494
230        229 0.021149323 0.17288247 0.48562131 0.320346902
231        230 0.020810934 0.17166676 0.48561095 0.321911357
232        231 0.020477959 0.17045732 0.48558989 0.323474834
233        232 0.020150311 0.16925417 0.48555821 0.325037310
234        233 0.019827906 0.16805731 0.48551602 0.326598762
235        234 0.019510660 0.16686676 0.48546341 0.328159167
236        235 0.019198489 0.16568252 0.48540049 0.329718501
237        236 0.018891314 0.16450460 0.48532734 0.331276742
238        237 0.018589052 0.16333301 0.48524407 0.332833868
239        238 0.018291628 0.16216775 0.48515077 0.334389856
240        239 0.017998962 0.16100882 0.48504754 0.335944684
241        240 0.017710978 0.15985623 0.48493446 0.337498330
242        241 0.017427603 0.15870999 0.48481164 0.339050772
243        242 0.017148761 0.15757008 0.48467917 0.340601989
244        243 0.016874381 0.15643652 0.48453714 0.342151961
245        244 0.016604391 0.15530930 0.48438564 0.343700665
246        245 0.016338720 0.15418843 0.48422477 0.345248081
247        246 0.016077301 0.15307389 0.48405462 0.346794188
248        247 0.015820064 0.15196569 0.48387528 0.348338966
249        248 0.015566943 0.15086382 0.48368684 0.349882395
250        249 0.015317872 0.14976828 0.48348939 0.351424454
251        250 0.015072786 0.14867907 0.48328302 0.352965124
252        251 0.014831621 0.14759617 0.48306782 0.354504386
253        252 0.014594315 0.14651958 0.48284388 0.356042219
254        253 0.014360806 0.14544930 0.48261129 0.357578605
255        254 0.014131034 0.14438531 0.48237014 0.359113524
256        255 0.013904937 0.14332760 0.48212050 0.360646958
257        256 0.013682458 0.14227618 0.48186247 0.362178888
258        257 0.013463539 0.14123102 0.48159614 0.363709296
259        258 0.013248122 0.14019212 0.48132159 0.365238164
260        259 0.013036152 0.13915946 0.48103891 0.366765473
261        260 0.012827574 0.13813304 0.48074818 0.368291206
262        261 0.012622333 0.13711284 0.48044948 0.369815344
263        262 0.012420375 0.13609885 0.48014290 0.371337871
264        263 0.012221649 0.13509106 0.47982853 0.372858770
265        264 0.012026103 0.13408944 0.47950643 0.374378023
266        265 0.011833685 0.13309399 0.47917671 0.375895613
267        266 0.011644346 0.13210470 0.47883943 0.377411524
268        267 0.011458037 0.13112154 0.47849468 0.378925739
269        268 0.011274708 0.13014451 0.47814255 0.380438241
270        269 0.011094313 0.12917357 0.47778310 0.381949016
271        270 0.010916804 0.12820873 0.47741642 0.383458046
272        271 0.010742135 0.12724996 0.47704259 0.384965317
273        272 0.010570261 0.12629724 0.47666169 0.386470812
274        273 0.010401137 0.12535055 0.47627379 0.387974516
275        274 0.010234718 0.12440989 0.47587898 0.389476413
276        275 0.010070963 0.12347522 0.47547733 0.390976490
277        276 0.009909827 0.12254653 0.47506891 0.392474731
278        277 0.009751270 0.12162381 0.47465380 0.393971120
279        278 0.009595250 0.12070702 0.47423209 0.395465645
280        279 0.009441726 0.11979615 0.47380383 0.396958290
281        280 0.009290658 0.11889119 0.47336912 0.398449041
282        281 0.009142008 0.11799210 0.47292801 0.399937885
283        282 0.008995736 0.11709887 0.47248059 0.401424807
284        283 0.008851804 0.11621148 0.47202692 0.402909794
285        284 0.008710175 0.11532990 0.47156709 0.404392832
286        285 0.008570812 0.11445412 0.47110116 0.405873909
287        286 0.008433679 0.11358411 0.47062920 0.407353010
288        287 0.008298740 0.11271985 0.47015129 0.408830123
289        288 0.008165960 0.11186132 0.46966749 0.410305236
290        289 0.008035305 0.11100849 0.46917787 0.411778335
291        290 0.007906740 0.11016134 0.46868251 0.413249408
292        291 0.007780232 0.10931985 0.46818148 0.414718443
293        292 0.007655749 0.10848399 0.46767483 0.416185428
294        293 0.007533257 0.10765375 0.46716265 0.417650350
295        294 0.007412725 0.10682909 0.46664499 0.419113198
296        295 0.007294121 0.10600999 0.46612193 0.420573960
297        296 0.007177415 0.10519644 0.46559352 0.422032625
298        297 0.007062576 0.10438840 0.46505985 0.423489181
299        298 0.006949575 0.10358585 0.46452096 0.424943618
300        299 0.006838382 0.10278876 0.46397693 0.426395923
301        300 0.006728968 0.10199712 0.46342783 0.427846087
302        301 0.006621304 0.10121089 0.46287371 0.429294098
303        302 0.006515364 0.10043005 0.46231464 0.430739945
304        303 0.006411118 0.09965458 0.46175068 0.432183620
305        304 0.006308540 0.09888445 0.46118190 0.433625110
306        305 0.006207603 0.09811964 0.46060835 0.435064407
307        306 0.006108282 0.09736011 0.46003011 0.436501499
308        307 0.006010549 0.09660585 0.45944722 0.437936378
309        308 0.005914380 0.09585683 0.45885976 0.439369033
310        309 0.005819750 0.09511302 0.45826778 0.440799455
311        310 0.005726634 0.09437439 0.45767134 0.442227635
312        311 0.005635008 0.09364093 0.45707050 0.443653562
313        312 0.005544848 0.09291260 0.45646532 0.445077229
314        313 0.005456130 0.09218938 0.45585586 0.446498627
315        314 0.005368832 0.09147125 0.45524218 0.447917745
316        315 0.005282931 0.09075817 0.45462433 0.449334576
317        316 0.005198404 0.09005012 0.45400237 0.450749111
318        317 0.005115230 0.08934707 0.45337636 0.452161341
319        318 0.005033386 0.08864900 0.45274635 0.453571259
320        319 0.004952852 0.08795589 0.45211240 0.454978856
321        320 0.004873606 0.08726770 0.45147457 0.456384124
322        321 0.004795628 0.08658441 0.45083291 0.457787055
323        322 0.004718898 0.08590599 0.45018747 0.459187642
324        323 0.004643396 0.08523241 0.44953832 0.460585876
325        324 0.004569102 0.08456366 0.44888549 0.461981751
326        325 0.004495996 0.08389970 0.44822905 0.463375258
327        326 0.004424060 0.08324050 0.44756905 0.464766391
328        327 0.004353275 0.08258604 0.44690554 0.466155143
329        328 0.004283623 0.08193630 0.44623857 0.467541506
330        329 0.004215085 0.08129125 0.44556820 0.468925473
331        330 0.004147643 0.08065085 0.44489447 0.470307038
332        331 0.004081281 0.08001509 0.44421743 0.471686195
333        332 0.004015981 0.07938394 0.44353714 0.473062936
334        333 0.003951725 0.07875737 0.44285365 0.474437255
335        334 0.003888497 0.07813535 0.44216701 0.475809147
336        335 0.003826281 0.07751786 0.44147725 0.477178604
337        336 0.003765061 0.07690488 0.44078444 0.478545621
338        337 0.003704820 0.07629636 0.44008862 0.479910192
339        338 0.003645543 0.07569230 0.43938984 0.481272311
340        339 0.003587214 0.07509267 0.43868815 0.482631972
341        340 0.003529819 0.07449742 0.43798359 0.483989170
342        341 0.003473342 0.07390655 0.43727621 0.485343899
343        342 0.003417768 0.07332003 0.43656605 0.486696154
344        343 0.003363084 0.07273782 0.43585316 0.488045930
345        344 0.003309274 0.07215991 0.43513760 0.489393222
346        345 0.003256326 0.07158626 0.43441939 0.490738024
347        346 0.003204225 0.07101685 0.43369859 0.492080331
348        347 0.003152957 0.07045166 0.43297524 0.493420140
349        348 0.003102510 0.06989066 0.43224939 0.494757444
350        349 0.003052870 0.06933382 0.43152107 0.496092240
351        350 0.003004024 0.06878111 0.43079034 0.497424523
352        351 0.002955959 0.06823252 0.43005723 0.498754289
353        352 0.002908664 0.06768802 0.42932179 0.500081533
354        353 0.002862125 0.06714757 0.42858405 0.501406251
355        354 0.002816331 0.06661116 0.42784407 0.502728439
356        355 0.002771270 0.06607876 0.42710187 0.504048093
357        356 0.002726930 0.06555035 0.42635751 0.505365209
358        357 0.002683299 0.06502589 0.42561102 0.506679784
359        358 0.002640366 0.06450537 0.42486245 0.507991813
360        359 0.002598120 0.06398876 0.42411182 0.509301294
361        360 0.002556550 0.06347604 0.42335919 0.510608222
362        361 0.002515646 0.06296717 0.42260459 0.511912594
363        362 0.002475395 0.06246214 0.42184806 0.513214407
364        363 0.002435789 0.06196091 0.42108964 0.514513657
365        364 0.002396816 0.06146347 0.42032937 0.515810343
366        365 0.002358467 0.06096980 0.41956728 0.517104459</code></pre>
</div>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="do">### Figure  </span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a><span class="co">#Y-axis: Probability</span></span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>stm3 <span class="sc">%&gt;%</span> </span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>()<span class="sc">+</span></span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(time_steps,S,<span class="at">color=</span><span class="st">"1. Susceptible"</span>))<span class="sc">+</span></span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(time_steps,E,<span class="at">color=</span><span class="st">"2. Exposed"</span>))<span class="sc">+</span></span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(time_steps,A,<span class="at">color=</span><span class="st">"3. Adopted"</span>))<span class="sc">+</span></span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(time_steps,R,<span class="at">color=</span><span class="st">"4. Reduced_weight"</span>))<span class="sc">+</span></span>
<span id="cb31-10"><a href="#cb31-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> scales<span class="sc">::</span>comma)<span class="sc">+</span></span>
<span id="cb31-11"><a href="#cb31-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title=</span><span class="st">"State Transition Model output - different starting probabilities"</span>,</span>
<span id="cb31-12"><a href="#cb31-12" aria-hidden="true" tabindex="-1"></a>       <span class="at">y    =</span> <span class="st">"Probability of different states"</span>,</span>
<span id="cb31-13"><a href="#cb31-13" aria-hidden="true" tabindex="-1"></a>       <span class="at">x    =</span><span class="st">"Days"</span>,</span>
<span id="cb31-14"><a href="#cb31-14" aria-hidden="true" tabindex="-1"></a>       <span class="at">color =</span> <span class="st">""</span>) <span class="sc">+</span></span>
<span id="cb31-15"><a href="#cb31-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb31-16"><a href="#cb31-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb31-17"><a href="#cb31-17" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position=</span><span class="st">"bottom"</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="SystemsScience_StateTransition_SEAR_FINAL_Solutions_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Solution: Changing these probabilities shifted the starting point for the exposed and adopted curves. Otherwise, the curves look similar to the main scenario.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="co">#(3) Use the original transition probabilities by rerunning the example code. Vary the probability of transition from susceptible to exposed to half of the original value, then also double. In each case, let this reduce the probability of transition from susceptible to susceptible to ensure the rows of the transition matrix sum to 1. What happens to the output figure?</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a><span class="co">#Rerun main scenario example code</span></span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>p_se <span class="ot">=</span> <span class="fl">0.012</span>  <span class="co"># Probability of moving from S to E (probability of being exposed to an intervention)</span></span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a><span class="co">#Probability of moving from susceptible to exposed.</span></span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a>p_sa <span class="ot">=</span> <span class="fl">0.003</span>  <span class="co"># Probability of moving from S to A (probability of adopting a behavior)</span></span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a><span class="co">#Probability of moving from susceptible to adopting a behavior.</span></span>
<span id="cb33-8"><a href="#cb33-8" aria-hidden="true" tabindex="-1"></a>p_sr <span class="ot">=</span> <span class="fl">0.001</span>  <span class="co"># Probability of moving from S to R (probability of being in reduced weight state)</span></span>
<span id="cb33-9"><a href="#cb33-9" aria-hidden="true" tabindex="-1"></a><span class="co">#Probability of moving from susceptible to reduced weight.</span></span>
<span id="cb33-10"><a href="#cb33-10" aria-hidden="true" tabindex="-1"></a>p_ea <span class="ot">=</span> <span class="fl">0.008</span>  <span class="co"># Probability of moving from E to A (probability of adopting a behavior)</span></span>
<span id="cb33-11"><a href="#cb33-11" aria-hidden="true" tabindex="-1"></a><span class="co">#Probability of mving from exposed to adopted behavior</span></span>
<span id="cb33-12"><a href="#cb33-12" aria-hidden="true" tabindex="-1"></a>p_er <span class="ot">=</span> <span class="fl">0.0005</span> <span class="co"># Probability of moving from E to R (probability of having a reduced weight)</span></span>
<span id="cb33-13"><a href="#cb33-13" aria-hidden="true" tabindex="-1"></a><span class="co">#Probability of moving from exposed  to reduced weight</span></span>
<span id="cb33-14"><a href="#cb33-14" aria-hidden="true" tabindex="-1"></a>p_ar <span class="ot">=</span> <span class="fl">0.003</span>  <span class="co"># Probability of moving from A to R (probability of having a reduced weight)</span></span>
<span id="cb33-15"><a href="#cb33-15" aria-hidden="true" tabindex="-1"></a><span class="co">#Probability of moving from behavior adopted to reduced weight</span></span>
<span id="cb33-16"><a href="#cb33-16" aria-hidden="true" tabindex="-1"></a>p_rr <span class="ot">=</span> <span class="dv">1</span>      <span class="co"># Probability of staying in the reduced weight state (must be one, absorbing state)</span></span>
<span id="cb33-17"><a href="#cb33-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-18"><a href="#cb33-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate complementary probabilities</span></span>
<span id="cb33-19"><a href="#cb33-19" aria-hidden="true" tabindex="-1"></a>p_ss <span class="ot">=</span> <span class="dv">1</span> <span class="sc">-</span> p_se <span class="sc">-</span> p_sa <span class="sc">-</span> p_sr  <span class="co"># Probability of staying in S</span></span>
<span id="cb33-20"><a href="#cb33-20" aria-hidden="true" tabindex="-1"></a>p_ee <span class="ot">=</span> <span class="dv">1</span> <span class="sc">-</span> p_ea <span class="sc">-</span> p_er         <span class="co"># Probability of staying in E</span></span>
<span id="cb33-21"><a href="#cb33-21" aria-hidden="true" tabindex="-1"></a>p_aa <span class="ot">=</span> <span class="dv">1</span> <span class="sc">-</span> p_ar                <span class="co"># Probability of staying in A</span></span>
<span id="cb33-22"><a href="#cb33-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-23"><a href="#cb33-23" aria-hidden="true" tabindex="-1"></a>transition_mat<span class="ot">=</span><span class="fu">matrix</span>(<span class="fu">c</span>(p_ss, p_se, p_sa, p_sr,</span>
<span id="cb33-24"><a href="#cb33-24" aria-hidden="true" tabindex="-1"></a>                        <span class="dv">0</span>,    p_ee, p_ea, p_er,  <span class="co"># Transitions from state S</span></span>
<span id="cb33-25"><a href="#cb33-25" aria-hidden="true" tabindex="-1"></a>                        <span class="dv">0</span>,    <span class="dv">0</span>,    p_aa, p_ar,  <span class="co"># Transitions from state A</span></span>
<span id="cb33-26"><a href="#cb33-26" aria-hidden="true" tabindex="-1"></a>                        <span class="dv">0</span>,    <span class="dv">0</span>,       <span class="dv">0</span>, p_rr), <span class="co"># Transitions from state R</span></span>
<span id="cb33-27"><a href="#cb33-27" aria-hidden="true" tabindex="-1"></a>                <span class="at">byrow =</span> <span class="cn">TRUE</span>,</span>
<span id="cb33-28"><a href="#cb33-28" aria-hidden="true" tabindex="-1"></a>                <span class="at">nrow =</span> <span class="dv">4</span>)</span>
<span id="cb33-29"><a href="#cb33-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-30"><a href="#cb33-30" aria-hidden="true" tabindex="-1"></a><span class="co">#transition matrix does not depend on time (does not depend on time)</span></span>
<span id="cb33-31"><a href="#cb33-31" aria-hidden="true" tabindex="-1"></a>transition_mat</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      [,1]   [,2]  [,3]  [,4]
[1,] 0.984 0.0120 0.003 1e-03
[2,] 0.000 0.9915 0.008 5e-04
[3,] 0.000 0.0000 0.997 3e-03
[4,] 0.000 0.0000 0.000 1e+00</code></pre>
</div>
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="co">#check that rows sum to 1</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a><span class="fu">rowSums</span>(transition_mat)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1 1 1 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(transition_mat) <span class="ot">&lt;-</span> <span class="fu">rownames</span>(transition_mat) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"S"</span>, <span class="st">"E"</span>, <span class="st">"A"</span>, <span class="st">"R"</span>)</span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a><span class="do">##  simulate markov-chain</span></span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a>time <span class="ot">=</span> <span class="dv">365</span>     <span class="co">#day intervals</span></span>
<span id="cb37-7"><a href="#cb37-7" aria-hidden="true" tabindex="-1"></a>transition_mat <span class="co">#time invariant</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      S      E     A     R
S 0.984 0.0120 0.003 1e-03
E 0.000 0.9915 0.008 5e-04
A 0.000 0.0000 0.997 3e-03
R 0.000 0.0000 0.000 1e+00</code></pre>
</div>
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="co">#P(E)=0.05 initially exposed and P(A)=0.02 initially adopted</span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a><span class="co">#Ensure the probabilities sum to 1</span></span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>initial_states <span class="ot">=</span> <span class="fu">c</span>(<span class="at">S=</span><span class="fl">0.93</span>,<span class="at">E=</span><span class="fl">0.05</span>,<span class="at">A=</span><span class="fl">0.02</span>, <span class="at">R=</span><span class="dv">0</span>)</span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a><span class="co">#Reduce the transition from S to E by 50%</span></span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-7"><a href="#cb39-7" aria-hidden="true" tabindex="-1"></a>p_se <span class="ot">=</span> <span class="fl">0.012</span><span class="sc">*</span><span class="fl">0.5</span>  <span class="co"># Probability of moving from S to E (probability of being exposed to an intervention)</span></span>
<span id="cb39-8"><a href="#cb39-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-9"><a href="#cb39-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate complementary probabilities</span></span>
<span id="cb39-10"><a href="#cb39-10" aria-hidden="true" tabindex="-1"></a>p_ss <span class="ot">=</span> <span class="dv">1</span> <span class="sc">-</span> p_se <span class="sc">-</span> p_sa <span class="sc">-</span> p_sr  <span class="co"># Probability of staying in S</span></span>
<span id="cb39-11"><a href="#cb39-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-12"><a href="#cb39-12" aria-hidden="true" tabindex="-1"></a>transition_mat<span class="ot">=</span><span class="fu">matrix</span>(<span class="fu">c</span>(p_ss, p_se, p_sa, p_sr,</span>
<span id="cb39-13"><a href="#cb39-13" aria-hidden="true" tabindex="-1"></a>                        <span class="dv">0</span>,    p_ee, p_ea, p_er, <span class="co"># Transitions from state S</span></span>
<span id="cb39-14"><a href="#cb39-14" aria-hidden="true" tabindex="-1"></a>                        <span class="dv">0</span>,    <span class="dv">0</span>,    p_aa, p_ar, <span class="co"># Transitions from state A</span></span>
<span id="cb39-15"><a href="#cb39-15" aria-hidden="true" tabindex="-1"></a>                        <span class="dv">0</span>,    <span class="dv">0</span>,       <span class="dv">0</span>, p_rr),<span class="co"># Transitions from state R</span></span>
<span id="cb39-16"><a href="#cb39-16" aria-hidden="true" tabindex="-1"></a>                <span class="at">byrow =</span> <span class="cn">TRUE</span>,</span>
<span id="cb39-17"><a href="#cb39-17" aria-hidden="true" tabindex="-1"></a>                <span class="at">nrow =</span> <span class="dv">4</span>)</span>
<span id="cb39-18"><a href="#cb39-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-19"><a href="#cb39-19" aria-hidden="true" tabindex="-1"></a><span class="co">#transition matrix does not depend on time (does not depend on time)</span></span>
<span id="cb39-20"><a href="#cb39-20" aria-hidden="true" tabindex="-1"></a>transition_mat</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     [,1]   [,2]  [,3]  [,4]
[1,] 0.99 0.0060 0.003 1e-03
[2,] 0.00 0.9915 0.008 5e-04
[3,] 0.00 0.0000 0.997 3e-03
[4,] 0.00 0.0000 0.000 1e+00</code></pre>
</div>
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="co">#check that rows sum to 1</span></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a><span class="fu">rowSums</span>(transition_mat)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1 1 1 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(transition_mat) <span class="ot">&lt;-</span> <span class="fu">rownames</span>(transition_mat) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"S"</span>, <span class="st">"E"</span>, <span class="st">"A"</span>, <span class="st">"R"</span>)</span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a>stm4 <span class="ot">&lt;-</span> <span class="fu">stm_simulation</span>(<span class="at">initial_state_vec=</span>initial_states, </span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a>                      <span class="at">transition_prob_mat=</span>transition_mat, </span>
<span id="cb43-6"><a href="#cb43-6" aria-hidden="true" tabindex="-1"></a>                      <span class="at">n_cycles =</span> time)</span>
<span id="cb43-7"><a href="#cb43-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-8"><a href="#cb43-8" aria-hidden="true" tabindex="-1"></a>stm4 <span class="ot">&lt;-</span> stm4 <span class="sc">%&gt;%</span> </span>
<span id="cb43-9"><a href="#cb43-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb43-10"><a href="#cb43-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rowid_to_column</span>(<span class="st">"time_steps"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb43-11"><a href="#cb43-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">time_steps=</span>time_steps<span class="dv">-1</span>)</span>
<span id="cb43-12"><a href="#cb43-12" aria-hidden="true" tabindex="-1"></a>stm4</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    time_steps          S          E          A           R
1            0 0.93000000 0.05000000 0.02000000 0.000000000
2            1 0.92070000 0.05515500 0.02313000 0.001015000
3            2 0.91149300 0.06021038 0.02626395 0.002032667
4            3 0.90237807 0.06516755 0.02940132 0.003053058
5            4 0.89335429 0.07002790 0.03254159 0.004076223
6            5 0.88442075 0.07479279 0.03568425 0.005102216
7            6 0.87557654 0.07946357 0.03882880 0.006131086
8            7 0.86682077 0.08404159 0.04197476 0.007162881
9            8 0.85815257 0.08852816 0.04512163 0.008197647
10           9 0.84957104 0.09292459 0.04826894 0.009235428
11          10 0.84107533 0.09723215 0.05141625 0.010276269
12          11 0.83266458 0.10145213 0.05456308 0.011320209
13          12 0.82433793 0.10558578 0.05770900 0.012367289
14          13 0.81609455 0.10963433 0.06085358 0.013417546
15          14 0.80793361 0.11359900 0.06399637 0.014471019
16          15 0.79985427 0.11748101 0.06713698 0.015527741
17          16 0.79185573 0.12128155 0.07027498 0.016587747
18          17 0.78393717 0.12500179 0.07340997 0.017651068
19          18 0.77609780 0.12864290 0.07654157 0.018717736
20          19 0.76833682 0.13220602 0.07966938 0.019787780
21          20 0.76065345 0.13569229 0.08279303 0.020861228
22          21 0.75304692 0.13910283 0.08591215 0.021938107
23          22 0.74551645 0.14243873 0.08902638 0.023018442
24          23 0.73806128 0.14570110 0.09213536 0.024102257
25          24 0.73068067 0.14889101 0.09523874 0.025189574
26          25 0.72337386 0.15200952 0.09833620 0.026280417
27          26 0.71614013 0.15505768 0.10142739 0.027374804
28          27 0.70897872 0.15803653 0.10451199 0.028472755
29          28 0.70188894 0.16094710 0.10758968 0.029574288
30          29 0.69487005 0.16379038 0.11066015 0.030679420
31          30 0.68792135 0.16656738 0.11372311 0.031788165
32          31 0.68104213 0.16927909 0.11677824 0.032900540
33          32 0.67423171 0.17192647 0.11982526 0.034016556
34          33 0.66748940 0.17451048 0.12286390 0.035136227
35          34 0.66081450 0.17703208 0.12589386 0.036259563
36          35 0.65420636 0.17949219 0.12891487 0.037386575
37          36 0.64766429 0.18189175 0.13192669 0.038517272
38          37 0.64118765 0.18423165 0.13492903 0.039651663
39          38 0.63477577 0.18651281 0.13792166 0.040789753
40          39 0.62842802 0.18873611 0.14090433 0.041931550
41          40 0.62214374 0.19090242 0.14387679 0.043077059
42          41 0.61592230 0.19301261 0.14683881 0.044226285
43          42 0.60976308 0.19506754 0.14979016 0.045379230
44          43 0.60366544 0.19706804 0.15273062 0.046535897
45          44 0.59762879 0.19901496 0.15565997 0.047696288
46          45 0.59165250 0.20090910 0.15857799 0.048860405
47          46 0.58573598 0.20275129 0.16148449 0.050028246
48          47 0.57987862 0.20454232 0.16437925 0.051199811
49          48 0.57407983 0.20628298 0.16726209 0.052375098
50          49 0.56833903 0.20797405 0.17013281 0.053554106
51          50 0.56265564 0.20961631 0.17299122 0.054736830
52          51 0.55702909 0.21121050 0.17583714 0.055923268
53          52 0.55145880 0.21275739 0.17867040 0.057113413
54          53 0.54594421 0.21425770 0.18149083 0.058307262
55          54 0.54048477 0.21571218 0.18429825 0.059504808
56          55 0.53507992 0.21712153 0.18709251 0.060706043
57          56 0.52972912 0.21848648 0.18987344 0.061910961
58          57 0.52443183 0.21980772 0.19264090 0.063119554
59          58 0.51918751 0.22108595 0.19539473 0.064331813
60          59 0.51399563 0.22232184 0.19813480 0.065547727
61          60 0.50885568 0.22351608 0.20086096 0.066767288
62          61 0.50376712 0.22466933 0.20357307 0.067990485
63          62 0.49872945 0.22578224 0.20627101 0.069217306
64          63 0.49374215 0.22685547 0.20895464 0.070447739
65          64 0.48880473 0.22788965 0.21162385 0.071681773
66          65 0.48391669 0.22888541 0.21427851 0.072919394
67          66 0.47907752 0.22984339 0.21691850 0.074160589
68          67 0.47428674 0.23076418 0.21954373 0.075405344
69          68 0.46954388 0.23164841 0.22215407 0.076653644
70          69 0.46484844 0.23249666 0.22474943 0.077905474
71          70 0.46019995 0.23330953 0.22732970 0.079160819
72          71 0.45559795 0.23408760 0.22989478 0.080419663
73          72 0.45104197 0.23483144 0.23244459 0.081681989
74          73 0.44653155 0.23554163 0.23497904 0.082947781
75          74 0.44206624 0.23621871 0.23749803 0.084217020
76          75 0.43764558 0.23686325 0.24000148 0.085489690
77          76 0.43326912 0.23747579 0.24248932 0.086765771
78          77 0.42893643 0.23805686 0.24496147 0.088045246
79          78 0.42464707 0.23860699 0.24741785 0.089328096
80          79 0.42040059 0.23912672 0.24985839 0.090614300
81          80 0.41619659 0.23961654 0.25228303 0.091903839
82          81 0.41203462 0.24007698 0.25469170 0.093196693
83          82 0.40791428 0.24050853 0.25708435 0.094492841
84          83 0.40383513 0.24091170 0.25946091 0.095792263
85          84 0.39979678 0.24128696 0.26182132 0.097094936
86          85 0.39579881 0.24163480 0.26416554 0.098400841
87          86 0.39184083 0.24195570 0.26649352 0.099709953
88          87 0.38792242 0.24225012 0.26880521 0.101022253
89          88 0.38404319 0.24251853 0.27110056 0.102337716
90          89 0.38020276 0.24276138 0.27337954 0.103656320
91          90 0.37640073 0.24297912 0.27564210 0.104978042
92          91 0.37263673 0.24317221 0.27788821 0.106302859
93          92 0.36891036 0.24334106 0.28011783 0.107630746
94          93 0.36522126 0.24348613 0.28233094 0.108961680
95          94 0.36156904 0.24360782 0.28452750 0.110295638
96          95 0.35795335 0.24370657 0.28670748 0.111632593
97          96 0.35437382 0.24378278 0.28887087 0.112972522
98          97 0.35083008 0.24383687 0.29101765 0.114315400
99          98 0.34732178 0.24386924 0.29314778 0.115661201
100         99 0.34384856 0.24388028 0.29526125 0.117009901
101        100 0.34041008 0.24387039 0.29735806 0.118361474
102        101 0.33700598 0.24383995 0.29943818 0.119715893
103        102 0.33363592 0.24378935 0.30150160 0.121073134
104        103 0.33029956 0.24371896 0.30354832 0.122433169
105        104 0.32699656 0.24362914 0.30557832 0.123795973
106        105 0.32372660 0.24352027 0.30759161 0.125161519
107        106 0.32048933 0.24339271 0.30958818 0.126529781
108        107 0.31728444 0.24324681 0.31156802 0.127900731
109        108 0.31411159 0.24308292 0.31353115 0.129274343
110        109 0.31097048 0.24290138 0.31547755 0.130650589
111        110 0.30786077 0.24270254 0.31740724 0.132029443
112        111 0.30478216 0.24248674 0.31932022 0.133410877
113        112 0.30173434 0.24225429 0.32121650 0.134794863
114        113 0.29871700 0.24200554 0.32309609 0.136181374
115        114 0.29572983 0.24174079 0.32495900 0.137570382
116        115 0.29277253 0.24146037 0.32680524 0.138961859
117        116 0.28984481 0.24116460 0.32863482 0.140355778
118        117 0.28694636 0.24085377 0.33044777 0.141752109
119        118 0.28407689 0.24052819 0.33224409 0.143150826
120        119 0.28123613 0.24018816 0.33402382 0.144551899
121        120 0.27842376 0.23983398 0.33578696 0.145955301
122        121 0.27563953 0.23946593 0.33753354 0.147361002
123        122 0.27288313 0.23908431 0.33926359 0.148768975
124        123 0.27015430 0.23868939 0.34097712 0.150179192
125        124 0.26745276 0.23828145 0.34267417 0.151591622
126        125 0.26477823 0.23786078 0.34435475 0.153006238
127        126 0.26213045 0.23742763 0.34601891 0.154423011
128        127 0.25950914 0.23698228 0.34766667 0.155841912
129        128 0.25691405 0.23652498 0.34929805 0.157262912
130        129 0.25434491 0.23605601 0.35091310 0.158685983
131        130 0.25180146 0.23557560 0.35251184 0.160111095
132        131 0.24928345 0.23508402 0.35409432 0.161538220
133        132 0.24679061 0.23458150 0.35566056 0.162967328
134        133 0.24432271 0.23406830 0.35721060 0.164398391
135        134 0.24187948 0.23354466 0.35874448 0.165831380
136        135 0.23946068 0.23301081 0.36026224 0.167266265
137        136 0.23706608 0.23246698 0.36176393 0.168703018
138        137 0.23469542 0.23191341 0.36324957 0.170141609
139        138 0.23234846 0.23135031 0.36471921 0.171582010
140        139 0.23002498 0.23077793 0.36617290 0.173024191
141        140 0.22772473 0.23019646 0.36761068 0.174468124
142        141 0.22544748 0.22960614 0.36903260 0.175913779
143        142 0.22319301 0.22900718 0.37043869 0.177361127
144        143 0.22096108 0.22839977 0.37182901 0.178810140
145        144 0.21875147 0.22778414 0.37320361 0.180260788
146        145 0.21656395 0.22716048 0.37456252 0.181713042
147        146 0.21439831 0.22652900 0.37590581 0.183166874
148        147 0.21225433 0.22588990 0.37723352 0.184622254
149        148 0.21013178 0.22524336 0.37854570 0.186079154
150        149 0.20803047 0.22458958 0.37984241 0.187537545
151        150 0.20595016 0.22392875 0.38112369 0.188997397
152        151 0.20389066 0.22326106 0.38238960 0.190458683
153        152 0.20185175 0.22258668 0.38364019 0.191921373
154        153 0.19983324 0.22190581 0.38487552 0.193385438
155        154 0.19783490 0.22121861 0.38609564 0.194850851
156        155 0.19585655 0.22052526 0.38730060 0.196317582
157        156 0.19389799 0.21982593 0.38849047 0.197785603
158        157 0.19195901 0.21912080 0.38966530 0.199254886
159        158 0.19003942 0.21841003 0.39082515 0.200725401
160        159 0.18813903 0.21769378 0.39197007 0.202197121
161        160 0.18625763 0.21697222 0.39310013 0.203670017
162        161 0.18439506 0.21624550 0.39421538 0.205144061
163        162 0.18255111 0.21551378 0.39531588 0.206619225
164        163 0.18072560 0.21477722 0.39640170 0.208095481
165        164 0.17891834 0.21403597 0.39747289 0.209572800
166        165 0.17712916 0.21329017 0.39852951 0.211051155
167        166 0.17535787 0.21253998 0.39957163 0.212530518
168        167 0.17360429 0.21178554 0.40059931 0.214010861
169        168 0.17186824 0.21102699 0.40161261 0.215492156
170        169 0.17014956 0.21026447 0.40261159 0.216974375
171        170 0.16844807 0.20949812 0.40359632 0.218457492
172        171 0.16676359 0.20872807 0.40456686 0.219941478
173        172 0.16509595 0.20795447 0.40552328 0.221426306
174        173 0.16344499 0.20717743 0.40646563 0.222911949
175        174 0.16181054 0.20639709 0.40739399 0.224398380
176        175 0.16019244 0.20561358 0.40830842 0.225885571
177        176 0.15859051 0.20482702 0.40920898 0.227373495
178        177 0.15700461 0.20403753 0.41009574 0.228862126
179        178 0.15543456 0.20324524 0.41096876 0.230351437
180        179 0.15388021 0.20245026 0.41182812 0.231841400
181        180 0.15234141 0.20165272 0.41267388 0.233331990
182        181 0.15081800 0.20085272 0.41350611 0.234823179
183        182 0.14930982 0.20005038 0.41432486 0.236314942
184        183 0.14781672 0.19924581 0.41513022 0.237807252
185        184 0.14633855 0.19843912 0.41592225 0.239300082
186        185 0.14487517 0.19763042 0.41670101 0.240793407
187        186 0.14342642 0.19681981 0.41746658 0.242287200
188        187 0.14199215 0.19600740 0.41821901 0.243781436
189        188 0.14057223 0.19519329 0.41895839 0.245276089
190        189 0.13916651 0.19437758 0.41968478 0.246771133
191        190 0.13777484 0.19356037 0.42039825 0.248266543
192        191 0.13639709 0.19274176 0.42109886 0.249762293
193        192 0.13503312 0.19192183 0.42178669 0.251258357
194        193 0.13368279 0.19110070 0.42246180 0.252754711
195        194 0.13234596 0.19027844 0.42312427 0.254251330
196        195 0.13102250 0.18945515 0.42377416 0.255748188
197        196 0.12971228 0.18863091 0.42441155 0.257245260
198        197 0.12841516 0.18780582 0.42503650 0.258742523
199        198 0.12713100 0.18697996 0.42564908 0.260239950
200        199 0.12585969 0.18615342 0.42624937 0.261737518
201        200 0.12460110 0.18532627 0.42683742 0.263235203
202        201 0.12335509 0.18449861 0.42741333 0.264732979
203        202 0.12212154 0.18367050 0.42797714 0.266230824
204        203 0.12090032 0.18284203 0.42852894 0.267728712
205        204 0.11969132 0.18201328 0.42906879 0.269226620
206        205 0.11849440 0.18118431 0.42959676 0.270724525
207        206 0.11730946 0.18035521 0.43011293 0.272222401
208        207 0.11613637 0.17952605 0.43061736 0.273720227
209        208 0.11497500 0.17869689 0.43111013 0.275217979
210        209 0.11382525 0.17786782 0.43159130 0.276715633
211        210 0.11268700 0.17703890 0.43206094 0.278213166
212        211 0.11156013 0.17621019 0.43251913 0.279710555
213        212 0.11044453 0.17538176 0.43296593 0.281207777
214        213 0.10934008 0.17455368 0.43340142 0.282704811
215        214 0.10824668 0.17372602 0.43382567 0.284201632
216        215 0.10716422 0.17289883 0.43423874 0.285698219
217        216 0.10609257 0.17207217 0.43464071 0.287194548
218        217 0.10503165 0.17124611 0.43503164 0.288690599
219        218 0.10398133 0.17042071 0.43541161 0.290186349
220        219 0.10294152 0.16959602 0.43578068 0.291681775
221        220 0.10191210 0.16877211 0.43613893 0.293176857
222        221 0.10089298 0.16794902 0.43648643 0.294671572
223        222 0.09988405 0.16712681 0.43682324 0.296165899
224        223 0.09888521 0.16630553 0.43714944 0.297659816
225        224 0.09789636 0.16548525 0.43746509 0.299153302
226        225 0.09691740 0.16466600 0.43777027 0.300646336
227        226 0.09594822 0.16384785 0.43806504 0.302138898
228        227 0.09498874 0.16303083 0.43834947 0.303630965
229        228 0.09403885 0.16221500 0.43862363 0.305122517
230        229 0.09309846 0.16140040 0.43888760 0.306613535
231        230 0.09216748 0.16058709 0.43914143 0.308103996
232        231 0.09124580 0.15977511 0.43938521 0.309593881
233        232 0.09033335 0.15896449 0.43961899 0.311083170
234        233 0.08943001 0.15815529 0.43984285 0.312571843
235        234 0.08853571 0.15734755 0.44005685 0.314059879
236        235 0.08765035 0.15654131 0.44026107 0.315547259
237        236 0.08677385 0.15573662 0.44045557 0.317033963
238        237 0.08590611 0.15493350 0.44064042 0.318519972
239        238 0.08504705 0.15413200 0.44081568 0.320005266
240        239 0.08419658 0.15333216 0.44098143 0.321489827
241        240 0.08335462 0.15253402 0.44113774 0.322973633
242        241 0.08252107 0.15173760 0.44128466 0.324456668
243        242 0.08169586 0.15094296 0.44142227 0.325938912
244        243 0.08087890 0.15015012 0.44155063 0.327420346
245        244 0.08007011 0.14935912 0.44166982 0.328900952
246        245 0.07926941 0.14856999 0.44177989 0.330380711
247        246 0.07847672 0.14778276 0.44188092 0.331859605
248        247 0.07769195 0.14699746 0.44197297 0.333337616
249        248 0.07691503 0.14621414 0.44205611 0.334814726
250        249 0.07614588 0.14543281 0.44213040 0.336290916
251        250 0.07538442 0.14465350 0.44219591 0.337766170
252        251 0.07463058 0.14387626 0.44225270 0.339240469
253        252 0.07388427 0.14310109 0.44230084 0.340713795
254        253 0.07314543 0.14232804 0.44234040 0.342186133
255        254 0.07241397 0.14155712 0.44237144 0.343657463
256        255 0.07168983 0.14078837 0.44239403 0.345127770
257        256 0.07097294 0.14002181 0.44240822 0.346597036
258        257 0.07026321 0.13925746 0.44241409 0.348065245
259        258 0.06956057 0.13849535 0.44241170 0.349532379
260        259 0.06886497 0.13773550 0.44240111 0.350998422
261        260 0.06817632 0.13697794 0.44238238 0.352463358
262        261 0.06749456 0.13622269 0.44235559 0.353927171
263        262 0.06681961 0.13546976 0.44232078 0.355389844
264        263 0.06615141 0.13471919 0.44227804 0.356851360
265        264 0.06548990 0.13397098 0.44222741 0.358311705
266        265 0.06483500 0.13322517 0.44216897 0.359770863
267        266 0.06418665 0.13248176 0.44210277 0.361228818
268        267 0.06354478 0.13174079 0.44202887 0.362685553
269        268 0.06290934 0.13100226 0.44194735 0.364141055
270        269 0.06228024 0.13026620 0.44185825 0.365595308
271        270 0.06165744 0.12953262 0.44176165 0.367048296
272        271 0.06104087 0.12880153 0.44165760 0.368500005
273        272 0.06043046 0.12807297 0.44154616 0.369950419
274        273 0.05982615 0.12734693 0.44142739 0.371399524
275        274 0.05922789 0.12662344 0.44130137 0.372847306
276        275 0.05863561 0.12590250 0.44116813 0.374293750
277        276 0.05804926 0.12518415 0.44102776 0.375738841
278        277 0.05746876 0.12446838 0.44088029 0.377182566
279        278 0.05689408 0.12375521 0.44072581 0.378624910
280        279 0.05632513 0.12304465 0.44056435 0.380065859
281        280 0.05576188 0.12233673 0.44039599 0.381505399
282        281 0.05520426 0.12163143 0.44022078 0.382943517
283        282 0.05465222 0.12092879 0.44003879 0.384380200
284        283 0.05410570 0.12022881 0.43985006 0.385815433
285        284 0.05356464 0.11953150 0.43965465 0.387249203
286        285 0.05302900 0.11883687 0.43945264 0.388681497
287        286 0.05249871 0.11814493 0.43924406 0.390112303
288        287 0.05197372 0.11745569 0.43902898 0.391541606
289        288 0.05145398 0.11676916 0.43880746 0.392969395
290        289 0.05093944 0.11608535 0.43857956 0.394395656
291        290 0.05043005 0.11540426 0.43834532 0.395820376
292        291 0.04992575 0.11472590 0.43810481 0.397243544
293        292 0.04942649 0.11405029 0.43785808 0.398665148
294        293 0.04893223 0.11337742 0.43760518 0.400085173
295        294 0.04844290 0.11270730 0.43734618 0.401503610
296        295 0.04795847 0.11203995 0.43708113 0.402920445
297        296 0.04747889 0.11137536 0.43681008 0.404335667
298        297 0.04700410 0.11071354 0.43653309 0.405749264
299        298 0.04653406 0.11005450 0.43625021 0.407161224
300        299 0.04606872 0.10939824 0.43596150 0.408571536
301        300 0.04560803 0.10874477 0.43566701 0.409980188
302        301 0.04515195 0.10809409 0.43536679 0.411387170
303        302 0.04470043 0.10744620 0.43506090 0.412792469
304        303 0.04425343 0.10680111 0.43474939 0.414196075
305        304 0.04381089 0.10615882 0.43443231 0.415597977
306        305 0.04337278 0.10551934 0.43410971 0.416998165
307        306 0.04293906 0.10488266 0.43378166 0.418396626
308        307 0.04250967 0.10424879 0.43344819 0.419793351
309        308 0.04208457 0.10361773 0.43310937 0.421188330
310        309 0.04166372 0.10298949 0.43276523 0.422581552
311        310 0.04124709 0.10236406 0.43241585 0.423973006
312        311 0.04083462 0.10174145 0.43206125 0.425362682
313        312 0.04042627 0.10112166 0.43170150 0.426750572
314        313 0.04002201 0.10050468 0.43133665 0.428136663
315        314 0.03962179 0.09989052 0.43096674 0.429520947
316        315 0.03922557 0.09927918 0.43059183 0.430903415
317        316 0.03883331 0.09867066 0.43021197 0.432284055
318        317 0.03844498 0.09806496 0.42982720 0.433662860
319        318 0.03806053 0.09746208 0.42943757 0.435039819
320        319 0.03767992 0.09686202 0.42904314 0.436414923
321        320 0.03730313 0.09626477 0.42864394 0.437788164
322        321 0.03693009 0.09567034 0.42824004 0.439159531
323        322 0.03656079 0.09507872 0.42783147 0.440529016
324        323 0.03619519 0.09448991 0.42741829 0.441896611
325        324 0.03583323 0.09390392 0.42700054 0.443262306
326        325 0.03547490 0.09332074 0.42657827 0.444626093
327        326 0.03512015 0.09274036 0.42615152 0.445987963
328        327 0.03476895 0.09216279 0.42572035 0.447347908
329        328 0.03442126 0.09158802 0.42528480 0.448705919
330        329 0.03407705 0.09101605 0.42484492 0.450061989
331        330 0.03373628 0.09044687 0.42440074 0.451416109
332        331 0.03339892 0.08988049 0.42395232 0.452768271
333        332 0.03306493 0.08931690 0.42349971 0.454118467
334        333 0.03273428 0.08875610 0.42304294 0.455466689
335        334 0.03240693 0.08819808 0.42258206 0.456812930
336        335 0.03208286 0.08764283 0.42211712 0.458157182
337        336 0.03176204 0.08709037 0.42164816 0.459499438
338        337 0.03144442 0.08654067 0.42117522 0.460839690
339        338 0.03112997 0.08599374 0.42069836 0.462177930
340        339 0.03081867 0.08544958 0.42021760 0.463514152
341        340 0.03051049 0.08490817 0.41973300 0.464848348
342        341 0.03020538 0.08436951 0.41924460 0.466180512
343        342 0.02990333 0.08383360 0.41875244 0.467510636
344        343 0.02960429 0.08330044 0.41825656 0.468838713
345        344 0.02930825 0.08277001 0.41775700 0.470164738
346        345 0.02901517 0.08224231 0.41725382 0.471488702
347        346 0.02872502 0.08171734 0.41674704 0.472810600
348        347 0.02843777 0.08119510 0.41623671 0.474130424
349        348 0.02815339 0.08067556 0.41572288 0.475448170
350        349 0.02787185 0.08015874 0.41520557 0.476763830
351        350 0.02759314 0.07964462 0.41468484 0.478077398
352        351 0.02731720 0.07913320 0.41416072 0.479388868
353        352 0.02704403 0.07862447 0.41363326 0.480698234
354        353 0.02677359 0.07811843 0.41310249 0.482005490
355        354 0.02650586 0.07761507 0.41256845 0.483310630
356        355 0.02624080 0.07711437 0.41203118 0.484613649
357        356 0.02597839 0.07661635 0.41149072 0.485914540
358        357 0.02571861 0.07612098 0.41094712 0.487213299
359        358 0.02546142 0.07562826 0.41040040 0.488509919
360        359 0.02520681 0.07513819 0.40985061 0.489804396
361        360 0.02495474 0.07465075 0.40929778 0.491096724
362        361 0.02470519 0.07416595 0.40874196 0.492386897
363        362 0.02445814 0.07368377 0.40818318 0.493674911
364        363 0.02421356 0.07320421 0.40762147 0.494960761
365        364 0.02397142 0.07272725 0.40705688 0.496244441
366        365 0.02373171 0.07225290 0.40648944 0.497525947</code></pre>
</div>
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="do">### Figure  </span></span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a><span class="co">#Y-axis: Probability</span></span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a>stm4 <span class="sc">%&gt;%</span> </span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>()<span class="sc">+</span></span>
<span id="cb45-6"><a href="#cb45-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(time_steps,S,<span class="at">color=</span><span class="st">"1. Susceptible"</span>))<span class="sc">+</span></span>
<span id="cb45-7"><a href="#cb45-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(time_steps,E,<span class="at">color=</span><span class="st">"2. Exposed"</span>))<span class="sc">+</span></span>
<span id="cb45-8"><a href="#cb45-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(time_steps,A,<span class="at">color=</span><span class="st">"3. Adopted"</span>))<span class="sc">+</span></span>
<span id="cb45-9"><a href="#cb45-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(time_steps,R,<span class="at">color=</span><span class="st">"4. Reduced_weight"</span>))<span class="sc">+</span></span>
<span id="cb45-10"><a href="#cb45-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> scales<span class="sc">::</span>comma)<span class="sc">+</span></span>
<span id="cb45-11"><a href="#cb45-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title=</span><span class="st">"State Transition Model output probability of S to E halved"</span>,</span>
<span id="cb45-12"><a href="#cb45-12" aria-hidden="true" tabindex="-1"></a>       <span class="at">y    =</span> <span class="st">"Probability of different states"</span>,</span>
<span id="cb45-13"><a href="#cb45-13" aria-hidden="true" tabindex="-1"></a>       <span class="at">x    =</span><span class="st">"Days"</span>,</span>
<span id="cb45-14"><a href="#cb45-14" aria-hidden="true" tabindex="-1"></a>       <span class="at">color =</span> <span class="st">""</span>) <span class="sc">+</span></span>
<span id="cb45-15"><a href="#cb45-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb45-16"><a href="#cb45-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb45-17"><a href="#cb45-17" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position=</span><span class="st">"bottom"</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="SystemsScience_StateTransition_SEAR_FINAL_Solutions_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Solution: When the transition probability from S to E is reduced by 50%, the exposed curve is flatter (slower increase) and the susceptible curve decreases more slowly. However, the other curves for exposed and adopted look similar to the main scenario.</span></span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a><span class="co">#Increase the transition from S to E by 200%</span></span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a>p_se <span class="ot">=</span> <span class="fl">0.012</span><span class="sc">*</span><span class="dv">2</span>  <span class="co"># Probability of moving from S to E (probability of being exposed to an intervention)</span></span>
<span id="cb46-6"><a href="#cb46-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-7"><a href="#cb46-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate complementary probabilities</span></span>
<span id="cb46-8"><a href="#cb46-8" aria-hidden="true" tabindex="-1"></a>p_ss <span class="ot">=</span> <span class="dv">1</span> <span class="sc">-</span> p_se <span class="sc">-</span> p_sa <span class="sc">-</span> p_sr  <span class="co"># Probability of staying in S</span></span>
<span id="cb46-9"><a href="#cb46-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-10"><a href="#cb46-10" aria-hidden="true" tabindex="-1"></a>transition_mat<span class="ot">=</span><span class="fu">matrix</span>(<span class="fu">c</span>(p_ss, p_se, p_sa, p_sr,</span>
<span id="cb46-11"><a href="#cb46-11" aria-hidden="true" tabindex="-1"></a>                        <span class="dv">0</span>,    p_ee, p_ea, p_er, <span class="co"># Transitions from state S</span></span>
<span id="cb46-12"><a href="#cb46-12" aria-hidden="true" tabindex="-1"></a>                        <span class="dv">0</span>,    <span class="dv">0</span>,    p_aa, p_ar, <span class="co"># Transitions from state A</span></span>
<span id="cb46-13"><a href="#cb46-13" aria-hidden="true" tabindex="-1"></a>                        <span class="dv">0</span>,    <span class="dv">0</span>,       <span class="dv">0</span>, p_rr),<span class="co"># Transitions from state R</span></span>
<span id="cb46-14"><a href="#cb46-14" aria-hidden="true" tabindex="-1"></a>                <span class="at">byrow =</span> <span class="cn">TRUE</span>,</span>
<span id="cb46-15"><a href="#cb46-15" aria-hidden="true" tabindex="-1"></a>                <span class="at">nrow =</span> <span class="dv">4</span>)</span>
<span id="cb46-16"><a href="#cb46-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-17"><a href="#cb46-17" aria-hidden="true" tabindex="-1"></a><span class="co">#transition matrix does not depend on time (does not depend on time)</span></span>
<span id="cb46-18"><a href="#cb46-18" aria-hidden="true" tabindex="-1"></a>transition_mat</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      [,1]   [,2]  [,3]  [,4]
[1,] 0.972 0.0240 0.003 1e-03
[2,] 0.000 0.9915 0.008 5e-04
[3,] 0.000 0.0000 0.997 3e-03
[4,] 0.000 0.0000 0.000 1e+00</code></pre>
</div>
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="co">#check that rows sum to 1</span></span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a><span class="fu">rowSums</span>(transition_mat)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1 1 1 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(transition_mat) <span class="ot">&lt;-</span> <span class="fu">rownames</span>(transition_mat) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"S"</span>, <span class="st">"E"</span>, <span class="st">"A"</span>, <span class="st">"R"</span>)</span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a>stm5 <span class="ot">&lt;-</span> <span class="fu">stm_simulation</span>(<span class="at">initial_state_vec=</span>initial_states, </span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a>                      <span class="at">transition_prob_mat=</span>transition_mat, </span>
<span id="cb50-6"><a href="#cb50-6" aria-hidden="true" tabindex="-1"></a>                      <span class="at">n_cycles =</span> time)</span>
<span id="cb50-7"><a href="#cb50-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-8"><a href="#cb50-8" aria-hidden="true" tabindex="-1"></a>stm5 <span class="ot">&lt;-</span> stm5 <span class="sc">%&gt;%</span> </span>
<span id="cb50-9"><a href="#cb50-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb50-10"><a href="#cb50-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rowid_to_column</span>(<span class="st">"time_steps"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb50-11"><a href="#cb50-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">time_steps=</span>time_steps<span class="dv">-1</span>)</span>
<span id="cb50-12"><a href="#cb50-12" aria-hidden="true" tabindex="-1"></a>stm4</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    time_steps          S          E          A           R
1            0 0.93000000 0.05000000 0.02000000 0.000000000
2            1 0.92070000 0.05515500 0.02313000 0.001015000
3            2 0.91149300 0.06021038 0.02626395 0.002032667
4            3 0.90237807 0.06516755 0.02940132 0.003053058
5            4 0.89335429 0.07002790 0.03254159 0.004076223
6            5 0.88442075 0.07479279 0.03568425 0.005102216
7            6 0.87557654 0.07946357 0.03882880 0.006131086
8            7 0.86682077 0.08404159 0.04197476 0.007162881
9            8 0.85815257 0.08852816 0.04512163 0.008197647
10           9 0.84957104 0.09292459 0.04826894 0.009235428
11          10 0.84107533 0.09723215 0.05141625 0.010276269
12          11 0.83266458 0.10145213 0.05456308 0.011320209
13          12 0.82433793 0.10558578 0.05770900 0.012367289
14          13 0.81609455 0.10963433 0.06085358 0.013417546
15          14 0.80793361 0.11359900 0.06399637 0.014471019
16          15 0.79985427 0.11748101 0.06713698 0.015527741
17          16 0.79185573 0.12128155 0.07027498 0.016587747
18          17 0.78393717 0.12500179 0.07340997 0.017651068
19          18 0.77609780 0.12864290 0.07654157 0.018717736
20          19 0.76833682 0.13220602 0.07966938 0.019787780
21          20 0.76065345 0.13569229 0.08279303 0.020861228
22          21 0.75304692 0.13910283 0.08591215 0.021938107
23          22 0.74551645 0.14243873 0.08902638 0.023018442
24          23 0.73806128 0.14570110 0.09213536 0.024102257
25          24 0.73068067 0.14889101 0.09523874 0.025189574
26          25 0.72337386 0.15200952 0.09833620 0.026280417
27          26 0.71614013 0.15505768 0.10142739 0.027374804
28          27 0.70897872 0.15803653 0.10451199 0.028472755
29          28 0.70188894 0.16094710 0.10758968 0.029574288
30          29 0.69487005 0.16379038 0.11066015 0.030679420
31          30 0.68792135 0.16656738 0.11372311 0.031788165
32          31 0.68104213 0.16927909 0.11677824 0.032900540
33          32 0.67423171 0.17192647 0.11982526 0.034016556
34          33 0.66748940 0.17451048 0.12286390 0.035136227
35          34 0.66081450 0.17703208 0.12589386 0.036259563
36          35 0.65420636 0.17949219 0.12891487 0.037386575
37          36 0.64766429 0.18189175 0.13192669 0.038517272
38          37 0.64118765 0.18423165 0.13492903 0.039651663
39          38 0.63477577 0.18651281 0.13792166 0.040789753
40          39 0.62842802 0.18873611 0.14090433 0.041931550
41          40 0.62214374 0.19090242 0.14387679 0.043077059
42          41 0.61592230 0.19301261 0.14683881 0.044226285
43          42 0.60976308 0.19506754 0.14979016 0.045379230
44          43 0.60366544 0.19706804 0.15273062 0.046535897
45          44 0.59762879 0.19901496 0.15565997 0.047696288
46          45 0.59165250 0.20090910 0.15857799 0.048860405
47          46 0.58573598 0.20275129 0.16148449 0.050028246
48          47 0.57987862 0.20454232 0.16437925 0.051199811
49          48 0.57407983 0.20628298 0.16726209 0.052375098
50          49 0.56833903 0.20797405 0.17013281 0.053554106
51          50 0.56265564 0.20961631 0.17299122 0.054736830
52          51 0.55702909 0.21121050 0.17583714 0.055923268
53          52 0.55145880 0.21275739 0.17867040 0.057113413
54          53 0.54594421 0.21425770 0.18149083 0.058307262
55          54 0.54048477 0.21571218 0.18429825 0.059504808
56          55 0.53507992 0.21712153 0.18709251 0.060706043
57          56 0.52972912 0.21848648 0.18987344 0.061910961
58          57 0.52443183 0.21980772 0.19264090 0.063119554
59          58 0.51918751 0.22108595 0.19539473 0.064331813
60          59 0.51399563 0.22232184 0.19813480 0.065547727
61          60 0.50885568 0.22351608 0.20086096 0.066767288
62          61 0.50376712 0.22466933 0.20357307 0.067990485
63          62 0.49872945 0.22578224 0.20627101 0.069217306
64          63 0.49374215 0.22685547 0.20895464 0.070447739
65          64 0.48880473 0.22788965 0.21162385 0.071681773
66          65 0.48391669 0.22888541 0.21427851 0.072919394
67          66 0.47907752 0.22984339 0.21691850 0.074160589
68          67 0.47428674 0.23076418 0.21954373 0.075405344
69          68 0.46954388 0.23164841 0.22215407 0.076653644
70          69 0.46484844 0.23249666 0.22474943 0.077905474
71          70 0.46019995 0.23330953 0.22732970 0.079160819
72          71 0.45559795 0.23408760 0.22989478 0.080419663
73          72 0.45104197 0.23483144 0.23244459 0.081681989
74          73 0.44653155 0.23554163 0.23497904 0.082947781
75          74 0.44206624 0.23621871 0.23749803 0.084217020
76          75 0.43764558 0.23686325 0.24000148 0.085489690
77          76 0.43326912 0.23747579 0.24248932 0.086765771
78          77 0.42893643 0.23805686 0.24496147 0.088045246
79          78 0.42464707 0.23860699 0.24741785 0.089328096
80          79 0.42040059 0.23912672 0.24985839 0.090614300
81          80 0.41619659 0.23961654 0.25228303 0.091903839
82          81 0.41203462 0.24007698 0.25469170 0.093196693
83          82 0.40791428 0.24050853 0.25708435 0.094492841
84          83 0.40383513 0.24091170 0.25946091 0.095792263
85          84 0.39979678 0.24128696 0.26182132 0.097094936
86          85 0.39579881 0.24163480 0.26416554 0.098400841
87          86 0.39184083 0.24195570 0.26649352 0.099709953
88          87 0.38792242 0.24225012 0.26880521 0.101022253
89          88 0.38404319 0.24251853 0.27110056 0.102337716
90          89 0.38020276 0.24276138 0.27337954 0.103656320
91          90 0.37640073 0.24297912 0.27564210 0.104978042
92          91 0.37263673 0.24317221 0.27788821 0.106302859
93          92 0.36891036 0.24334106 0.28011783 0.107630746
94          93 0.36522126 0.24348613 0.28233094 0.108961680
95          94 0.36156904 0.24360782 0.28452750 0.110295638
96          95 0.35795335 0.24370657 0.28670748 0.111632593
97          96 0.35437382 0.24378278 0.28887087 0.112972522
98          97 0.35083008 0.24383687 0.29101765 0.114315400
99          98 0.34732178 0.24386924 0.29314778 0.115661201
100         99 0.34384856 0.24388028 0.29526125 0.117009901
101        100 0.34041008 0.24387039 0.29735806 0.118361474
102        101 0.33700598 0.24383995 0.29943818 0.119715893
103        102 0.33363592 0.24378935 0.30150160 0.121073134
104        103 0.33029956 0.24371896 0.30354832 0.122433169
105        104 0.32699656 0.24362914 0.30557832 0.123795973
106        105 0.32372660 0.24352027 0.30759161 0.125161519
107        106 0.32048933 0.24339271 0.30958818 0.126529781
108        107 0.31728444 0.24324681 0.31156802 0.127900731
109        108 0.31411159 0.24308292 0.31353115 0.129274343
110        109 0.31097048 0.24290138 0.31547755 0.130650589
111        110 0.30786077 0.24270254 0.31740724 0.132029443
112        111 0.30478216 0.24248674 0.31932022 0.133410877
113        112 0.30173434 0.24225429 0.32121650 0.134794863
114        113 0.29871700 0.24200554 0.32309609 0.136181374
115        114 0.29572983 0.24174079 0.32495900 0.137570382
116        115 0.29277253 0.24146037 0.32680524 0.138961859
117        116 0.28984481 0.24116460 0.32863482 0.140355778
118        117 0.28694636 0.24085377 0.33044777 0.141752109
119        118 0.28407689 0.24052819 0.33224409 0.143150826
120        119 0.28123613 0.24018816 0.33402382 0.144551899
121        120 0.27842376 0.23983398 0.33578696 0.145955301
122        121 0.27563953 0.23946593 0.33753354 0.147361002
123        122 0.27288313 0.23908431 0.33926359 0.148768975
124        123 0.27015430 0.23868939 0.34097712 0.150179192
125        124 0.26745276 0.23828145 0.34267417 0.151591622
126        125 0.26477823 0.23786078 0.34435475 0.153006238
127        126 0.26213045 0.23742763 0.34601891 0.154423011
128        127 0.25950914 0.23698228 0.34766667 0.155841912
129        128 0.25691405 0.23652498 0.34929805 0.157262912
130        129 0.25434491 0.23605601 0.35091310 0.158685983
131        130 0.25180146 0.23557560 0.35251184 0.160111095
132        131 0.24928345 0.23508402 0.35409432 0.161538220
133        132 0.24679061 0.23458150 0.35566056 0.162967328
134        133 0.24432271 0.23406830 0.35721060 0.164398391
135        134 0.24187948 0.23354466 0.35874448 0.165831380
136        135 0.23946068 0.23301081 0.36026224 0.167266265
137        136 0.23706608 0.23246698 0.36176393 0.168703018
138        137 0.23469542 0.23191341 0.36324957 0.170141609
139        138 0.23234846 0.23135031 0.36471921 0.171582010
140        139 0.23002498 0.23077793 0.36617290 0.173024191
141        140 0.22772473 0.23019646 0.36761068 0.174468124
142        141 0.22544748 0.22960614 0.36903260 0.175913779
143        142 0.22319301 0.22900718 0.37043869 0.177361127
144        143 0.22096108 0.22839977 0.37182901 0.178810140
145        144 0.21875147 0.22778414 0.37320361 0.180260788
146        145 0.21656395 0.22716048 0.37456252 0.181713042
147        146 0.21439831 0.22652900 0.37590581 0.183166874
148        147 0.21225433 0.22588990 0.37723352 0.184622254
149        148 0.21013178 0.22524336 0.37854570 0.186079154
150        149 0.20803047 0.22458958 0.37984241 0.187537545
151        150 0.20595016 0.22392875 0.38112369 0.188997397
152        151 0.20389066 0.22326106 0.38238960 0.190458683
153        152 0.20185175 0.22258668 0.38364019 0.191921373
154        153 0.19983324 0.22190581 0.38487552 0.193385438
155        154 0.19783490 0.22121861 0.38609564 0.194850851
156        155 0.19585655 0.22052526 0.38730060 0.196317582
157        156 0.19389799 0.21982593 0.38849047 0.197785603
158        157 0.19195901 0.21912080 0.38966530 0.199254886
159        158 0.19003942 0.21841003 0.39082515 0.200725401
160        159 0.18813903 0.21769378 0.39197007 0.202197121
161        160 0.18625763 0.21697222 0.39310013 0.203670017
162        161 0.18439506 0.21624550 0.39421538 0.205144061
163        162 0.18255111 0.21551378 0.39531588 0.206619225
164        163 0.18072560 0.21477722 0.39640170 0.208095481
165        164 0.17891834 0.21403597 0.39747289 0.209572800
166        165 0.17712916 0.21329017 0.39852951 0.211051155
167        166 0.17535787 0.21253998 0.39957163 0.212530518
168        167 0.17360429 0.21178554 0.40059931 0.214010861
169        168 0.17186824 0.21102699 0.40161261 0.215492156
170        169 0.17014956 0.21026447 0.40261159 0.216974375
171        170 0.16844807 0.20949812 0.40359632 0.218457492
172        171 0.16676359 0.20872807 0.40456686 0.219941478
173        172 0.16509595 0.20795447 0.40552328 0.221426306
174        173 0.16344499 0.20717743 0.40646563 0.222911949
175        174 0.16181054 0.20639709 0.40739399 0.224398380
176        175 0.16019244 0.20561358 0.40830842 0.225885571
177        176 0.15859051 0.20482702 0.40920898 0.227373495
178        177 0.15700461 0.20403753 0.41009574 0.228862126
179        178 0.15543456 0.20324524 0.41096876 0.230351437
180        179 0.15388021 0.20245026 0.41182812 0.231841400
181        180 0.15234141 0.20165272 0.41267388 0.233331990
182        181 0.15081800 0.20085272 0.41350611 0.234823179
183        182 0.14930982 0.20005038 0.41432486 0.236314942
184        183 0.14781672 0.19924581 0.41513022 0.237807252
185        184 0.14633855 0.19843912 0.41592225 0.239300082
186        185 0.14487517 0.19763042 0.41670101 0.240793407
187        186 0.14342642 0.19681981 0.41746658 0.242287200
188        187 0.14199215 0.19600740 0.41821901 0.243781436
189        188 0.14057223 0.19519329 0.41895839 0.245276089
190        189 0.13916651 0.19437758 0.41968478 0.246771133
191        190 0.13777484 0.19356037 0.42039825 0.248266543
192        191 0.13639709 0.19274176 0.42109886 0.249762293
193        192 0.13503312 0.19192183 0.42178669 0.251258357
194        193 0.13368279 0.19110070 0.42246180 0.252754711
195        194 0.13234596 0.19027844 0.42312427 0.254251330
196        195 0.13102250 0.18945515 0.42377416 0.255748188
197        196 0.12971228 0.18863091 0.42441155 0.257245260
198        197 0.12841516 0.18780582 0.42503650 0.258742523
199        198 0.12713100 0.18697996 0.42564908 0.260239950
200        199 0.12585969 0.18615342 0.42624937 0.261737518
201        200 0.12460110 0.18532627 0.42683742 0.263235203
202        201 0.12335509 0.18449861 0.42741333 0.264732979
203        202 0.12212154 0.18367050 0.42797714 0.266230824
204        203 0.12090032 0.18284203 0.42852894 0.267728712
205        204 0.11969132 0.18201328 0.42906879 0.269226620
206        205 0.11849440 0.18118431 0.42959676 0.270724525
207        206 0.11730946 0.18035521 0.43011293 0.272222401
208        207 0.11613637 0.17952605 0.43061736 0.273720227
209        208 0.11497500 0.17869689 0.43111013 0.275217979
210        209 0.11382525 0.17786782 0.43159130 0.276715633
211        210 0.11268700 0.17703890 0.43206094 0.278213166
212        211 0.11156013 0.17621019 0.43251913 0.279710555
213        212 0.11044453 0.17538176 0.43296593 0.281207777
214        213 0.10934008 0.17455368 0.43340142 0.282704811
215        214 0.10824668 0.17372602 0.43382567 0.284201632
216        215 0.10716422 0.17289883 0.43423874 0.285698219
217        216 0.10609257 0.17207217 0.43464071 0.287194548
218        217 0.10503165 0.17124611 0.43503164 0.288690599
219        218 0.10398133 0.17042071 0.43541161 0.290186349
220        219 0.10294152 0.16959602 0.43578068 0.291681775
221        220 0.10191210 0.16877211 0.43613893 0.293176857
222        221 0.10089298 0.16794902 0.43648643 0.294671572
223        222 0.09988405 0.16712681 0.43682324 0.296165899
224        223 0.09888521 0.16630553 0.43714944 0.297659816
225        224 0.09789636 0.16548525 0.43746509 0.299153302
226        225 0.09691740 0.16466600 0.43777027 0.300646336
227        226 0.09594822 0.16384785 0.43806504 0.302138898
228        227 0.09498874 0.16303083 0.43834947 0.303630965
229        228 0.09403885 0.16221500 0.43862363 0.305122517
230        229 0.09309846 0.16140040 0.43888760 0.306613535
231        230 0.09216748 0.16058709 0.43914143 0.308103996
232        231 0.09124580 0.15977511 0.43938521 0.309593881
233        232 0.09033335 0.15896449 0.43961899 0.311083170
234        233 0.08943001 0.15815529 0.43984285 0.312571843
235        234 0.08853571 0.15734755 0.44005685 0.314059879
236        235 0.08765035 0.15654131 0.44026107 0.315547259
237        236 0.08677385 0.15573662 0.44045557 0.317033963
238        237 0.08590611 0.15493350 0.44064042 0.318519972
239        238 0.08504705 0.15413200 0.44081568 0.320005266
240        239 0.08419658 0.15333216 0.44098143 0.321489827
241        240 0.08335462 0.15253402 0.44113774 0.322973633
242        241 0.08252107 0.15173760 0.44128466 0.324456668
243        242 0.08169586 0.15094296 0.44142227 0.325938912
244        243 0.08087890 0.15015012 0.44155063 0.327420346
245        244 0.08007011 0.14935912 0.44166982 0.328900952
246        245 0.07926941 0.14856999 0.44177989 0.330380711
247        246 0.07847672 0.14778276 0.44188092 0.331859605
248        247 0.07769195 0.14699746 0.44197297 0.333337616
249        248 0.07691503 0.14621414 0.44205611 0.334814726
250        249 0.07614588 0.14543281 0.44213040 0.336290916
251        250 0.07538442 0.14465350 0.44219591 0.337766170
252        251 0.07463058 0.14387626 0.44225270 0.339240469
253        252 0.07388427 0.14310109 0.44230084 0.340713795
254        253 0.07314543 0.14232804 0.44234040 0.342186133
255        254 0.07241397 0.14155712 0.44237144 0.343657463
256        255 0.07168983 0.14078837 0.44239403 0.345127770
257        256 0.07097294 0.14002181 0.44240822 0.346597036
258        257 0.07026321 0.13925746 0.44241409 0.348065245
259        258 0.06956057 0.13849535 0.44241170 0.349532379
260        259 0.06886497 0.13773550 0.44240111 0.350998422
261        260 0.06817632 0.13697794 0.44238238 0.352463358
262        261 0.06749456 0.13622269 0.44235559 0.353927171
263        262 0.06681961 0.13546976 0.44232078 0.355389844
264        263 0.06615141 0.13471919 0.44227804 0.356851360
265        264 0.06548990 0.13397098 0.44222741 0.358311705
266        265 0.06483500 0.13322517 0.44216897 0.359770863
267        266 0.06418665 0.13248176 0.44210277 0.361228818
268        267 0.06354478 0.13174079 0.44202887 0.362685553
269        268 0.06290934 0.13100226 0.44194735 0.364141055
270        269 0.06228024 0.13026620 0.44185825 0.365595308
271        270 0.06165744 0.12953262 0.44176165 0.367048296
272        271 0.06104087 0.12880153 0.44165760 0.368500005
273        272 0.06043046 0.12807297 0.44154616 0.369950419
274        273 0.05982615 0.12734693 0.44142739 0.371399524
275        274 0.05922789 0.12662344 0.44130137 0.372847306
276        275 0.05863561 0.12590250 0.44116813 0.374293750
277        276 0.05804926 0.12518415 0.44102776 0.375738841
278        277 0.05746876 0.12446838 0.44088029 0.377182566
279        278 0.05689408 0.12375521 0.44072581 0.378624910
280        279 0.05632513 0.12304465 0.44056435 0.380065859
281        280 0.05576188 0.12233673 0.44039599 0.381505399
282        281 0.05520426 0.12163143 0.44022078 0.382943517
283        282 0.05465222 0.12092879 0.44003879 0.384380200
284        283 0.05410570 0.12022881 0.43985006 0.385815433
285        284 0.05356464 0.11953150 0.43965465 0.387249203
286        285 0.05302900 0.11883687 0.43945264 0.388681497
287        286 0.05249871 0.11814493 0.43924406 0.390112303
288        287 0.05197372 0.11745569 0.43902898 0.391541606
289        288 0.05145398 0.11676916 0.43880746 0.392969395
290        289 0.05093944 0.11608535 0.43857956 0.394395656
291        290 0.05043005 0.11540426 0.43834532 0.395820376
292        291 0.04992575 0.11472590 0.43810481 0.397243544
293        292 0.04942649 0.11405029 0.43785808 0.398665148
294        293 0.04893223 0.11337742 0.43760518 0.400085173
295        294 0.04844290 0.11270730 0.43734618 0.401503610
296        295 0.04795847 0.11203995 0.43708113 0.402920445
297        296 0.04747889 0.11137536 0.43681008 0.404335667
298        297 0.04700410 0.11071354 0.43653309 0.405749264
299        298 0.04653406 0.11005450 0.43625021 0.407161224
300        299 0.04606872 0.10939824 0.43596150 0.408571536
301        300 0.04560803 0.10874477 0.43566701 0.409980188
302        301 0.04515195 0.10809409 0.43536679 0.411387170
303        302 0.04470043 0.10744620 0.43506090 0.412792469
304        303 0.04425343 0.10680111 0.43474939 0.414196075
305        304 0.04381089 0.10615882 0.43443231 0.415597977
306        305 0.04337278 0.10551934 0.43410971 0.416998165
307        306 0.04293906 0.10488266 0.43378166 0.418396626
308        307 0.04250967 0.10424879 0.43344819 0.419793351
309        308 0.04208457 0.10361773 0.43310937 0.421188330
310        309 0.04166372 0.10298949 0.43276523 0.422581552
311        310 0.04124709 0.10236406 0.43241585 0.423973006
312        311 0.04083462 0.10174145 0.43206125 0.425362682
313        312 0.04042627 0.10112166 0.43170150 0.426750572
314        313 0.04002201 0.10050468 0.43133665 0.428136663
315        314 0.03962179 0.09989052 0.43096674 0.429520947
316        315 0.03922557 0.09927918 0.43059183 0.430903415
317        316 0.03883331 0.09867066 0.43021197 0.432284055
318        317 0.03844498 0.09806496 0.42982720 0.433662860
319        318 0.03806053 0.09746208 0.42943757 0.435039819
320        319 0.03767992 0.09686202 0.42904314 0.436414923
321        320 0.03730313 0.09626477 0.42864394 0.437788164
322        321 0.03693009 0.09567034 0.42824004 0.439159531
323        322 0.03656079 0.09507872 0.42783147 0.440529016
324        323 0.03619519 0.09448991 0.42741829 0.441896611
325        324 0.03583323 0.09390392 0.42700054 0.443262306
326        325 0.03547490 0.09332074 0.42657827 0.444626093
327        326 0.03512015 0.09274036 0.42615152 0.445987963
328        327 0.03476895 0.09216279 0.42572035 0.447347908
329        328 0.03442126 0.09158802 0.42528480 0.448705919
330        329 0.03407705 0.09101605 0.42484492 0.450061989
331        330 0.03373628 0.09044687 0.42440074 0.451416109
332        331 0.03339892 0.08988049 0.42395232 0.452768271
333        332 0.03306493 0.08931690 0.42349971 0.454118467
334        333 0.03273428 0.08875610 0.42304294 0.455466689
335        334 0.03240693 0.08819808 0.42258206 0.456812930
336        335 0.03208286 0.08764283 0.42211712 0.458157182
337        336 0.03176204 0.08709037 0.42164816 0.459499438
338        337 0.03144442 0.08654067 0.42117522 0.460839690
339        338 0.03112997 0.08599374 0.42069836 0.462177930
340        339 0.03081867 0.08544958 0.42021760 0.463514152
341        340 0.03051049 0.08490817 0.41973300 0.464848348
342        341 0.03020538 0.08436951 0.41924460 0.466180512
343        342 0.02990333 0.08383360 0.41875244 0.467510636
344        343 0.02960429 0.08330044 0.41825656 0.468838713
345        344 0.02930825 0.08277001 0.41775700 0.470164738
346        345 0.02901517 0.08224231 0.41725382 0.471488702
347        346 0.02872502 0.08171734 0.41674704 0.472810600
348        347 0.02843777 0.08119510 0.41623671 0.474130424
349        348 0.02815339 0.08067556 0.41572288 0.475448170
350        349 0.02787185 0.08015874 0.41520557 0.476763830
351        350 0.02759314 0.07964462 0.41468484 0.478077398
352        351 0.02731720 0.07913320 0.41416072 0.479388868
353        352 0.02704403 0.07862447 0.41363326 0.480698234
354        353 0.02677359 0.07811843 0.41310249 0.482005490
355        354 0.02650586 0.07761507 0.41256845 0.483310630
356        355 0.02624080 0.07711437 0.41203118 0.484613649
357        356 0.02597839 0.07661635 0.41149072 0.485914540
358        357 0.02571861 0.07612098 0.41094712 0.487213299
359        358 0.02546142 0.07562826 0.41040040 0.488509919
360        359 0.02520681 0.07513819 0.40985061 0.489804396
361        360 0.02495474 0.07465075 0.40929778 0.491096724
362        361 0.02470519 0.07416595 0.40874196 0.492386897
363        362 0.02445814 0.07368377 0.40818318 0.493674911
364        363 0.02421356 0.07320421 0.40762147 0.494960761
365        364 0.02397142 0.07272725 0.40705688 0.496244441
366        365 0.02373171 0.07225290 0.40648944 0.497525947</code></pre>
</div>
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="do">### Figure  </span></span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a><span class="co">#Y-axis: Probability</span></span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a>stm5 <span class="sc">%&gt;%</span> </span>
<span id="cb52-5"><a href="#cb52-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>()<span class="sc">+</span></span>
<span id="cb52-6"><a href="#cb52-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(time_steps,S,<span class="at">color=</span><span class="st">"1. Susceptible"</span>))<span class="sc">+</span></span>
<span id="cb52-7"><a href="#cb52-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(time_steps,E,<span class="at">color=</span><span class="st">"2. Exposed"</span>))<span class="sc">+</span></span>
<span id="cb52-8"><a href="#cb52-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(time_steps,A,<span class="at">color=</span><span class="st">"3. Adopted"</span>))<span class="sc">+</span></span>
<span id="cb52-9"><a href="#cb52-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(time_steps,R,<span class="at">color=</span><span class="st">"4. Reduced_weight"</span>))<span class="sc">+</span></span>
<span id="cb52-10"><a href="#cb52-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> scales<span class="sc">::</span>comma)<span class="sc">+</span></span>
<span id="cb52-11"><a href="#cb52-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title=</span><span class="st">"State Transition Model output probability of S to E double"</span>,</span>
<span id="cb52-12"><a href="#cb52-12" aria-hidden="true" tabindex="-1"></a>       <span class="at">y    =</span> <span class="st">"Probability of different states"</span>,</span>
<span id="cb52-13"><a href="#cb52-13" aria-hidden="true" tabindex="-1"></a>       <span class="at">x    =</span><span class="st">"Days"</span>,</span>
<span id="cb52-14"><a href="#cb52-14" aria-hidden="true" tabindex="-1"></a>       <span class="at">color =</span> <span class="st">""</span>) <span class="sc">+</span></span>
<span id="cb52-15"><a href="#cb52-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb52-16"><a href="#cb52-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb52-17"><a href="#cb52-17" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position=</span><span class="st">"bottom"</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="SystemsScience_StateTransition_SEAR_FINAL_Solutions_files/figure-html/unnamed-chunk-4-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Solution:  When the transition probability from S to E is increased by 200%, the exposed curve is steeper and peaks more quickly and the susceptible curve decreases more quickly. However, the other curves for adopted and reduced weight look similar to the main scenario. </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>